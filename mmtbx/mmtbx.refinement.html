<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>mmtbx.refinement package &#8212; CCTBX Developer documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/classic.css?v=514cf933" />
    
    <script src="../_static/documentation_options.js?v=9c77bcdb"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mmtbx.refinement.ensemble_refinement package" href="mmtbx.refinement.ensemble_refinement.html" />
    <link rel="prev" title="mmtbx.real_space package" href="mmtbx.real_space.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mmtbx.refinement.ensemble_refinement.html" title="mmtbx.refinement.ensemble_refinement package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mmtbx.real_space.html" title="mmtbx.real_space package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CCTBX Developer documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="mmtbx.html" accesskey="U">mmtbx - macromolecular crystallography</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">mmtbx.refinement package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="mmtbx-refinement-package">
<h1>mmtbx.refinement package<a class="headerlink" href="#mmtbx-refinement-package" title="Link to this heading">¶</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html">mmtbx.refinement.ensemble_refinement package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx-refinement-ensemble-refinement-ensemble-utils-module">mmtbx.refinement.ensemble_refinement.ensemble_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.closest_to_mean"><code class="docutils literal notranslate"><span class="pre">closest_to_mean()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.dist2"><code class="docutils literal notranslate"><span class="pre">dist2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.ensemble_mean_hierarchy"><code class="docutils literal notranslate"><span class="pre">ensemble_mean_hierarchy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.get_centroid_hierarchy"><code class="docutils literal notranslate"><span class="pre">get_centroid_hierarchy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.get_rmsf_B_factor_per_residue_per_atom"><code class="docutils literal notranslate"><span class="pre">get_rmsf_B_factor_per_residue_per_atom()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.get_selected_hierarchys"><code class="docutils literal notranslate"><span class="pre">get_selected_hierarchys()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.get_sites_carts"><code class="docutils literal notranslate"><span class="pre">get_sites_carts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager"><code class="docutils literal notranslate"><span class="pre">manager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.bin_generator_equal_range"><code class="docutils literal notranslate"><span class="pre">manager.bin_generator_equal_range()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.bin_generator_equal_size"><code class="docutils literal notranslate"><span class="pre">manager.bin_generator_equal_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.bivariate_histogram"><code class="docutils literal notranslate"><span class="pre">manager.bivariate_histogram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.ensemble_mean_geometry_stats"><code class="docutils literal notranslate"><span class="pre">manager.ensemble_mean_geometry_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.ensemble_reduction"><code class="docutils literal notranslate"><span class="pre">manager.ensemble_reduction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.ensemble_rmsf_stats"><code class="docutils literal notranslate"><span class="pre">manager.ensemble_rmsf_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.kinetic_energy_stats"><code class="docutils literal notranslate"><span class="pre">manager.kinetic_energy_stats()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.print_atom_statisitics"><code class="docutils literal notranslate"><span class="pre">manager.print_atom_statisitics()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.write_centroid_hierarchy"><code class="docutils literal notranslate"><span class="pre">manager.write_centroid_hierarchy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.manager.write_mean_hierarchy"><code class="docutils literal notranslate"><span class="pre">manager.write_mean_hierarchy()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#mmtbx.refinement.ensemble_refinement.ensemble_utils.selector"><code class="docutils literal notranslate"><span class="pre">selector()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#module-contents">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mmtbx.refinement.real_space.html">mmtbx.refinement.real_space package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx-refinement-real-space-fit-residue-module">mmtbx.refinement.real_space.fit_residue module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.backrub_move"><code class="docutils literal notranslate"><span class="pre">backrub_move()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.flatten"><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.get_rotamer_iterator"><code class="docutils literal notranslate"><span class="pre">get_rotamer_iterator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.monitor"><code class="docutils literal notranslate"><span class="pre">monitor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.monitor.add"><code class="docutils literal notranslate"><span class="pre">monitor.add()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.monitor.finalize"><code class="docutils literal notranslate"><span class="pre">monitor.finalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.monitor.show"><code class="docutils literal notranslate"><span class="pre">monitor.show()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run"><code class="docutils literal notranslate"><span class="pre">run</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run.fit_c_beta"><code class="docutils literal notranslate"><span class="pre">run.fit_c_beta()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run.fit_proline"><code class="docutils literal notranslate"><span class="pre">run.fit_proline()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run.fit_side_chain"><code class="docutils literal notranslate"><span class="pre">run.fit_side_chain()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run.get_rotamer_iterator"><code class="docutils literal notranslate"><span class="pre">run.get_rotamer_iterator()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run.get_target_value"><code class="docutils literal notranslate"><span class="pre">run.get_target_value()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run_with_minimization"><code class="docutils literal notranslate"><span class="pre">run_with_minimization</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run_with_minimization.fit_backbone"><code class="docutils literal notranslate"><span class="pre">run_with_minimization.fit_backbone()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run_with_minimization.fit_rotamers"><code class="docutils literal notranslate"><span class="pre">run_with_minimization.fit_rotamers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run_with_minimization.grid_sample_around_c_n_axis"><code class="docutils literal notranslate"><span class="pre">run_with_minimization.grid_sample_around_c_n_axis()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.run_with_minimization.real_space_refine"><code class="docutils literal notranslate"><span class="pre">run_with_minimization.real_space_refine()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residue.tune_up"><code class="docutils literal notranslate"><span class="pre">tune_up</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx-refinement-real-space-fit-residues-module">mmtbx.refinement.real_space.fit_residues module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residues.fix_outliers"><code class="docutils literal notranslate"><span class="pre">fix_outliers</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residues.run"><code class="docutils literal notranslate"><span class="pre">run</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residues.run.count_outliers"><code class="docutils literal notranslate"><span class="pre">run.count_outliers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residues.run.get_nonbonded_bumpers"><code class="docutils literal notranslate"><span class="pre">run.get_nonbonded_bumpers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residues.run.loop"><code class="docutils literal notranslate"><span class="pre">run.loop()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residues.run.one_residue_iteration"><code class="docutils literal notranslate"><span class="pre">run.one_residue_iteration()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_residues.run.show"><code class="docutils literal notranslate"><span class="pre">run.show()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx-refinement-real-space-fit-water-module">mmtbx.refinement.real_space.fit_water module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.fit_water.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx-refinement-real-space-individual-sites-module">mmtbx.refinement.real_space.individual_sites module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.box_refinement_manager"><code class="docutils literal notranslate"><span class="pre">box_refinement_manager</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.box_refinement_manager.refine"><code class="docutils literal notranslate"><span class="pre">box_refinement_manager.refine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.box_refinement_manager.update_target_map"><code class="docutils literal notranslate"><span class="pre">box_refinement_manager.update_target_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.box_refinement_manager.update_xray_structure"><code class="docutils literal notranslate"><span class="pre">box_refinement_manager.update_xray_structure()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.diff_map"><code class="docutils literal notranslate"><span class="pre">diff_map</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.diff_map.refine"><code class="docutils literal notranslate"><span class="pre">diff_map.refine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.diff_map.sites_cart"><code class="docutils literal notranslate"><span class="pre">diff_map.sites_cart()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.easy"><code class="docutils literal notranslate"><span class="pre">easy</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.minimize_wrapper_with_map"><code class="docutils literal notranslate"><span class="pre">minimize_wrapper_with_map</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.refinery"><code class="docutils literal notranslate"><span class="pre">refinery</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.refinery.adjust_weight_sample_rate"><code class="docutils literal notranslate"><span class="pre">refinery.adjust_weight_sample_rate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.refinery.rmsds"><code class="docutils literal notranslate"><span class="pre">refinery.rmsds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.simple"><code class="docutils literal notranslate"><span class="pre">simple</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.simple.refine"><code class="docutils literal notranslate"><span class="pre">simple.refine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.simple.rmsds"><code class="docutils literal notranslate"><span class="pre">simple.rmsds()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.individual_sites.simple.sites_cart"><code class="docutils literal notranslate"><span class="pre">simple.sites_cart()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx-refinement-real-space-rigid-body-module">mmtbx.refinement.real_space.rigid_body module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rigid_body.real_space_rigid_body_gradients_simple"><code class="docutils literal notranslate"><span class="pre">real_space_rigid_body_gradients_simple()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rigid_body.refine"><code class="docutils literal notranslate"><span class="pre">refine</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rigid_body.refine.compute_functional_and_gradients"><code class="docutils literal notranslate"><span class="pre">refine.compute_functional_and_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rigid_body.refine.d_e_pot_d_sites"><code class="docutils literal notranslate"><span class="pre">refine.d_e_pot_d_sites()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rigid_body.refine_groups"><code class="docutils literal notranslate"><span class="pre">refine_groups</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rigid_body.refine_mz"><code class="docutils literal notranslate"><span class="pre">refine_mz</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx-refinement-real-space-weight-module">mmtbx.refinement.real_space.weight module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.weight.run"><code class="docutils literal notranslate"><span class="pre">run</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.weight.run.show"><code class="docutils literal notranslate"><span class="pre">run.show()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#module-contents">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.aa_residue_axes_and_clusters"><code class="docutils literal notranslate"><span class="pre">aa_residue_axes_and_clusters</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.check_sites_match"><code class="docutils literal notranslate"><span class="pre">check_sites_match()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.cluster"><code class="docutils literal notranslate"><span class="pre">cluster</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.cluster.get_vector_flat"><code class="docutils literal notranslate"><span class="pre">cluster.get_vector_flat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.cluster.show"><code class="docutils literal notranslate"><span class="pre">cluster.show()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.common_map_values"><code class="docutils literal notranslate"><span class="pre">common_map_values()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.flatten"><code class="docutils literal notranslate"><span class="pre">flatten()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.generate_angles_nested"><code class="docutils literal notranslate"><span class="pre">generate_angles_nested()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.get_radii"><code class="docutils literal notranslate"><span class="pre">get_radii()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.get_radius"><code class="docutils literal notranslate"><span class="pre">get_radius()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.negate_map_around_selected_atoms_except_selected_atoms"><code class="docutils literal notranslate"><span class="pre">negate_map_around_selected_atoms_except_selected_atoms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.residue_monitor"><code class="docutils literal notranslate"><span class="pre">residue_monitor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.residue_monitor.format_info_string"><code class="docutils literal notranslate"><span class="pre">residue_monitor.format_info_string()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rsr_model"><code class="docutils literal notranslate"><span class="pre">rsr_model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rsr_model.initialize"><code class="docutils literal notranslate"><span class="pre">rsr_model.initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rsr_model.show"><code class="docutils literal notranslate"><span class="pre">rsr_model.show()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rsr_model.update"><code class="docutils literal notranslate"><span class="pre">rsr_model.update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.rsr_model.update_statistics"><code class="docutils literal notranslate"><span class="pre">rsr_model.update_statistics()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score"><code class="docutils literal notranslate"><span class="pre">score</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score.compute_target"><code class="docutils literal notranslate"><span class="pre">score.compute_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score.reset"><code class="docutils literal notranslate"><span class="pre">score.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score.update"><code class="docutils literal notranslate"><span class="pre">score.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score2"><code class="docutils literal notranslate"><span class="pre">score2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score2.update"><code class="docutils literal notranslate"><span class="pre">score2.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score3"><code class="docutils literal notranslate"><span class="pre">score3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score3.compute_target"><code class="docutils literal notranslate"><span class="pre">score3.compute_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score3.reset"><code class="docutils literal notranslate"><span class="pre">score3.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score3.update"><code class="docutils literal notranslate"><span class="pre">score3.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score4"><code class="docutils literal notranslate"><span class="pre">score4</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score4.compute_target"><code class="docutils literal notranslate"><span class="pre">score4.compute_target()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score4.reset"><code class="docutils literal notranslate"><span class="pre">score4.reset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.score4.update"><code class="docutils literal notranslate"><span class="pre">score4.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.selection_around_to_negate"><code class="docutils literal notranslate"><span class="pre">selection_around_to_negate()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.setup_test"><code class="docutils literal notranslate"><span class="pre">setup_test()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.side_chain_fit_evaluator"><code class="docutils literal notranslate"><span class="pre">side_chain_fit_evaluator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.side_chain_fit_evaluator.sel_all"><code class="docutils literal notranslate"><span class="pre">side_chain_fit_evaluator.sel_all()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.side_chain_fit_evaluator.sel_outliers"><code class="docutils literal notranslate"><span class="pre">side_chain_fit_evaluator.sel_outliers()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.side_chain_fit_evaluator.sel_outliers_and_poormap"><code class="docutils literal notranslate"><span class="pre">side_chain_fit_evaluator.sel_outliers_and_poormap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.side_chain_fit_evaluator.sel_outliers_or_poormap"><code class="docutils literal notranslate"><span class="pre">side_chain_fit_evaluator.sel_outliers_or_poormap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.side_chain_fit_evaluator.sel_poormap"><code class="docutils literal notranslate"><span class="pre">side_chain_fit_evaluator.sel_poormap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.side_chain_fit_evaluator.show"><code class="docutils literal notranslate"><span class="pre">side_chain_fit_evaluator.show()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.structure_monitor"><code class="docutils literal notranslate"><span class="pre">structure_monitor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.structure_monitor.assert_pdb_hierarchy_xray_structure_sync"><code class="docutils literal notranslate"><span class="pre">structure_monitor.assert_pdb_hierarchy_xray_structure_sync()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.structure_monitor.compute_map"><code class="docutils literal notranslate"><span class="pre">structure_monitor.compute_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.structure_monitor.initialize"><code class="docutils literal notranslate"><span class="pre">structure_monitor.initialize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.structure_monitor.map_cc"><code class="docutils literal notranslate"><span class="pre">structure_monitor.map_cc()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.structure_monitor.map_cc_histogram_per_atom"><code class="docutils literal notranslate"><span class="pre">structure_monitor.map_cc_histogram_per_atom()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.structure_monitor.show"><code class="docutils literal notranslate"><span class="pre">structure_monitor.show()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.structure_monitor.show_residues"><code class="docutils literal notranslate"><span class="pre">structure_monitor.show_residues()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.structure_monitor.update"><code class="docutils literal notranslate"><span class="pre">structure_monitor.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.torsion_search"><code class="docutils literal notranslate"><span class="pre">torsion_search()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="mmtbx.refinement.real_space.html#mmtbx.refinement.real_space.torsion_search_nested"><code class="docutils literal notranslate"><span class="pre">torsion_search_nested()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">¶</a></h2>
</section>
<section id="mmtbx-refinement-adp-refinement-module">
<h2>mmtbx.refinement.adp_refinement module<a class="headerlink" href="#mmtbx-refinement-adp-refinement-module" title="Link to this heading">¶</a></h2>
<dl class="py class" id="module-mmtbx.refinement.adp_refinement">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.manager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.adp_refinement.</span></span><span class="sig-name descname"><span class="pre">manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_adp_selections=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_adp_selections_h=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_adp_params=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tls_selections=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tls_params=&lt;libtbx.phil.scope_extract</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual_adp_params=&lt;libtbx.phil.scope_extract</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_restraints_params=&lt;libtbx.phil.scope_extract</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp_individual=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp_group=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_tls=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tan_b_iso_max=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_manager=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_weights=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">macro_cycle=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_params=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nproc=None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.manager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.refine_adp">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.adp_refinement.</span></span><span class="sig-name descname"><span class="pre">refine_adp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual_adp_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_restraints_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nproc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.refine_adp.minimize">
<span class="sig-name descname"><span class="pre">minimize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.minimize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.refine_adp.run_lbfgs">
<span class="sig-name descname"><span class="pre">run_lbfgs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.run_lbfgs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.refine_adp.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfrw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">score_target_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secondary_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.score" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.refine_adp.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rfrw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deltab</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.select" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.refine_adp.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_neutron</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.refine_adp.try_weight">
<span class="sig-name descname"><span class="pre">try_weight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">print_stats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.try_weight" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.show_times">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.adp_refinement.</span></span><span class="sig-name descname"><span class="pre">show_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.show_times" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.weight_result">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.adp_refinement.</span></span><span class="sig-name descname"><span class="pre">weight_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_work</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_free</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_b</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neutron_r_work</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neutron_r_free</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_star</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_iso</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.weight_result" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.adp_refinement.weight_result.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.weight_result.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="mmtbx-refinement-anomalous-scatterer-groups-module">
<h2>mmtbx.refinement.anomalous_scatterer_groups module<a class="headerlink" href="#mmtbx-refinement-anomalous-scatterer-groups-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.anomalous_scatterer_groups">
<dt class="sig sig-object py" id="mmtbx.refinement.anomalous_scatterer_groups.find_anomalous_scatterer_groups">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.anomalous_scatterer_groups.</span></span><span class="sig-name descname"><span class="pre">find_anomalous_scatterer_groups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_same_element</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.find_anomalous_scatterer_groups" title="Link to this definition">¶</a></dt>
<dd><p>Automatic setup of anomalously scattering atoms, defined here as anything
with atomic number 15 (P) or greater.  Not yet accessible from phenix.refine.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.anomalous_scatterer_groups.get_single_atom_selection_string">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.anomalous_scatterer_groups.</span></span><span class="sig-name descname"><span class="pre">get_single_atom_selection_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.get_single_atom_selection_string" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.anomalous_scatterer_groups.minimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.anomalous_scatterer_groups.</span></span><span class="sig-name descname"><span class="pre">minimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_back_after_minimizer_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_minimizer_cycles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbfgs_max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_finite_difference_tests</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.minimizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.anomalous_scatterer_groups.minimizer.compute_functional_and_gradients">
<span class="sig-name descname"><span class="pre">compute_functional_and_gradients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.minimizer.compute_functional_and_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.anomalous_scatterer_groups.minimizer.unpack">
<span class="sig-name descname"><span class="pre">unpack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.minimizer.unpack" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.anomalous_scatterer_groups.refine_anomalous_substructure">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.anomalous_scatterer_groups.</span></span><span class="sig-name descname"><span class="pre">refine_anomalous_substructure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdb_hierarchy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_type='anom_residual'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_waters=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_non_water_light_elements=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cycles_max=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_sigma_min=3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine=('f_prime'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">'f_double_prime')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_water_u_iso=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_all_anomalous=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.refine_anomalous_substructure" title="Link to this definition">¶</a></dt>
<dd><p>Crude mimic of Phaser’s substructure completion, with two essential
differences: only the existing real scatterers in the input model will be
used (with the assumption that the model is already more or less complete),
and the anomalous refinement will be performed in Phenix, yielding both
f-prime and f-double-prime.  The refined f-prime provides us with an
orthogonal estimate of the number of electrons missing from an incorrectly
labeled scatterer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelength</strong> – X-ray wavelenth in Angstroms</p></li>
<li><p><strong>exclude_waters</strong> – Don’t refine anomalous scattering for water oxygens</p></li>
<li><p><strong>exclude_non_water_light_elements</strong> – Don’t refine anomalous scattering
for light atoms other than water (CHNO).</p></li>
<li><p><strong>n_cycles_max</strong> – Maximum number of refinement cycles</p></li>
<li><p><strong>map_sigma_min</strong> – Sigma cutoff for identify anomalous scatterers</p></li>
<li><p><strong>reset_water_u_iso</strong> – Reset B-factors for water atoms prior to f’
refinement</p></li>
<li><p><strong>use_all_anomalous</strong> – include any scatterers which are already modeled
as anomalous in the refinement</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="mmtbx-refinement-fit-rotamers-module">
<h2>mmtbx.refinement.fit_rotamers module<a class="headerlink" href="#mmtbx-refinement-fit-rotamers-module" title="Link to this heading">¶</a></h2>
</section>
<section id="mmtbx-refinement-flip-peptides-module">
<h2>mmtbx.refinement.flip_peptides module<a class="headerlink" href="#mmtbx-refinement-flip-peptides-module" title="Link to this heading">¶</a></h2>
</section>
<section id="mmtbx-refinement-geometry-minimization-module">
<h2>mmtbx.refinement.geometry_minimization module<a class="headerlink" href="#mmtbx-refinement-geometry-minimization-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.geometry_minimization">
<dt class="sig sig-object py" id="mmtbx.refinement.geometry_minimization.add_rotamer_restraints">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.geometry_minimization.</span></span><span class="sig-name descname"><span class="pre">add_rotamer_restraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_hierarchy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accept_allowed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mon_lib_srv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotamer_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.add_rotamer_restraints" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.geometry_minimization.lbfgs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.geometry_minimization.</span></span><span class="sig-name descname"><span class="pre">lbfgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry_restraints_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geometry_restraints_flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbfgs_termination_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_special_position_tolerance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">riding_h_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_cart_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbfgs_exception_handling_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsd_bonds_termination_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsd_angles_termination_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states_collector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.lbfgs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../cctbx/cctbx.geometry_restraints.lbfgs.html#cctbx.geometry_restraints.lbfgs.lbfgs" title="cctbx.geometry_restraints.lbfgs.lbfgs"><code class="xref py py-class docutils literal notranslate"><span class="pre">lbfgs</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.geometry_minimization.lbfgs.callback_after_step">
<span class="sig-name descname"><span class="pre">callback_after_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.lbfgs.callback_after_step" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.geometry_minimization.minimize_wrapper_for_ramachandran">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.geometry_minimization.</span></span><span class="sig-name descname"><span class="pre">minimize_wrapper_for_ramachandran</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original_pdb_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excl_string_selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">processed_pdb_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_rotamers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_cycles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_first_minimization_without_reference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oldfield_weight_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oldfield_plot_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.03</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonbonded_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reference_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.minimize_wrapper_for_ramachandran" title="Link to this definition">¶</a></dt>
<dd><p>Wrapper around geometry minimization specifically tuned for eliminating
Ramachandran outliers.
probably not working anymore… no processed_pdb_file available.
WARNING: no setting sites_cart at the end…</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.geometry_minimization.run2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.geometry_minimization.</span></span><span class="sig-name descname"><span class="pre">run2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">restraints_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdb_hierarchy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_special_position_tolerance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">riding_h_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncs_restraints_group_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_macro_cycles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bond</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonbonded</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihedral</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chirality</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">planarity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parallelity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsd_bonds_termination_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsd_angles_termination_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alternate_nonbonded_off_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cdl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rdl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_hydrogens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_rotamer_outliers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_allowed_rotamers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states_collector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mon_lib_srv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ias_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.run2" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.geometry_minimization.run2.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.run2.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.geometry_minimization.run2.update_cdl_restraints">
<span class="sig-name descname"><span class="pre">update_cdl_restraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">macro_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.run2.update_cdl_restraints" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.geometry_minimization.run2.updaterdl">
<span class="sig-name descname"><span class="pre">updaterdl</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.run2.updaterdl" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="mmtbx-refinement-group-module">
<h2>mmtbx.refinement.group module<a class="headerlink" href="#mmtbx-refinement-group-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.group">
<dt class="sig sig-object py" id="mmtbx.refinement.group.apply_transformation">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.group.</span></span><span class="sig-name descname"><span class="pre">apply_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sc_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_occ</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.apply_transformation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.group.group_minimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.group.</span></span><span class="sig-name descname"><span class="pre">group_minimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sc_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_finite_differences_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.group_minimizer.apply_shifts">
<span class="sig-name descname"><span class="pre">apply_shifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.apply_shifts" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.group_minimizer.compute_functional_and_gradients">
<span class="sig-name descname"><span class="pre">compute_functional_and_gradients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.compute_functional_and_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.group_minimizer.finite_difference_test">
<span class="sig-name descname"><span class="pre">finite_difference_test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.finite_difference_test" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.group_minimizer.get_restraints_tg">
<span class="sig-name descname"><span class="pre">get_restraints_tg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.get_restraints_tg" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.group_minimizer.get_tg">
<span class="sig-name descname"><span class="pre">get_tg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.get_tg" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.group_minimizer.pack">
<span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.pack" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.group_minimizer.unpack_x">
<span class="sig-name descname"><span class="pre">unpack_x</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.unpack_x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.group.manager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.group.</span></span><span class="sig-name descname"><span class="pre">manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_macro_cycles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_restraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convergence_delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">run_finite_differences_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.manager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.manager.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tw</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">it</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.manager.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.group.show_times">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.group.</span></span><span class="sig-name descname"><span class="pre">show_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.show_times" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.group.sphere_similarity_restraints">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.group.</span></span><span class="sig-name descname"><span class="pre">sphere_similarity_restraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sphere_radius</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.sphere_similarity_restraints" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.sphere_similarity_restraints.target_and_gradients">
<span class="sig-name descname"><span class="pre">target_and_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_compute_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.sphere_similarity_restraints.target_and_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.group.target_and_grads">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.group.</span></span><span class="sig-name descname"><span class="pre">target_and_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_functor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_occ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rtg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.target_and_grads" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.target_and_grads.gradients_wrt_par">
<span class="sig-name descname"><span class="pre">gradients_wrt_par</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.target_and_grads.gradients_wrt_par" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.group.target_and_grads.target">
<span class="sig-name descname"><span class="pre">target</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.target_and_grads.target" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="mmtbx-refinement-inspect-tardy-trajectory-module">
<h2>mmtbx.refinement.inspect_tardy_trajectory module<a class="headerlink" href="#mmtbx-refinement-inspect-tardy-trajectory-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.inspect_tardy_trajectory">
<dt class="sig sig-object py" id="mmtbx.refinement.inspect_tardy_trajectory.run">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.inspect_tardy_trajectory.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.inspect_tardy_trajectory.run" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="mmtbx-refinement-minimization-module">
<h2>mmtbx.refinement.minimization module<a class="headerlink" href="#mmtbx-refinement-minimization-module" title="Link to this heading">¶</a></h2>
<dl class="py class" id="module-mmtbx.refinement.minimization">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.lbfgs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization.</span></span><span class="sig-name descname"><span class="pre">lbfgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_neutron_scat_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbfgs_termination_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_fortran</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">correct_special_position_tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iso_restraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qblib_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">macro_cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-0.06332573977646111</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">12.665021303812669</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collect_monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.lbfgs.apply_shifts">
<span class="sig-name descname"><span class="pre">apply_shifts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs.apply_shifts" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.lbfgs.callback_after_step">
<span class="sig-name descname"><span class="pre">callback_after_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">minimizer</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs.callback_after_step" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.lbfgs.compute_functional_and_gradients">
<span class="sig-name descname"><span class="pre">compute_functional_and_gradients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs.compute_functional_and_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.lbfgs.compute_target">
<span class="sig-name descname"><span class="pre">compute_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_iso_refinable_params</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs.compute_target" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.monitor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization.</span></span><span class="sig-name descname"><span class="pre">monitor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iso_restraints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_xyz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_adp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_occ</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.monitor.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nfun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor.collect" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.monitor.neutron_line">
<span class="sig-name descname"><span class="pre">neutron_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_seq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor.neutron_line" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.monitor.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.monitor.xray_line">
<span class="sig-name descname"><span class="pre">xray_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">i_seq</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor.xray_line" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization.run_constrained">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization.</span></span><span class="sig-name descname"><span class="pre">run_constrained</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_u_iso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_transformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.run_constrained" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

</section>
<section id="mmtbx-refinement-minimization-ncs-constraints-module">
<h2>mmtbx.refinement.minimization_ncs_constraints module<a class="headerlink" href="#mmtbx-refinement-minimization-ncs-constraints-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.minimization_ncs_constraints">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.grads_asu_to_one_ncs">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization_ncs_constraints.</span></span><span class="sig-name descname"><span class="pre">grads_asu_to_one_ncs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncs_restraints_group_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extended_ncs_selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_sites</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.grads_asu_to_one_ncs" title="Link to this definition">¶</a></dt>
<dd><p>Apply NCS constraints to reduce the gradients corresponding to whole ASU, to
gradients corresponding to one NCS copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncs_restraints_group_list</strong> – list of ncs_restraint_group objects</p></li>
<li><p><strong>grad</strong> – gradient of the complete asu</p></li>
<li><p><strong>refine_sites</strong> – (bool) Flag indicating sites refinement</p></li>
<li><p><strong>extended_ncs_selection</strong> (<em>flex.siz_t</em>) – selection of all ncs groups master ncs
selection and non ncs related portions that are being refined (exclude
NCS copies)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.grads_one_ncs_to_asu">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization_ncs_constraints.</span></span><span class="sig-name descname"><span class="pre">grads_one_ncs_to_asu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncs_restraints_group_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_asu_length</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extended_ncs_selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">master_grad</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.grads_one_ncs_to_asu" title="Link to this definition">¶</a></dt>
<dd><p>Expand average gradient of a single NCS to all ASU
(only for u_iso refinement)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncs_restraints_group_list</strong> – list of ncs_restraint_group objects</p></li>
<li><p><strong>total_asu_length</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.int" title="scitbx.array_family.flex.int"><em>int</em></a>) – length of the complete ASU</p></li>
<li><p><strong>extended_ncs_selection</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.size_t" title="scitbx.array_family.flex.size_t"><em>flex.size_t</em></a>) – selection of all ncs groups master ncs
selection and non ncs related portions that are being refined (exclude
NCS copies)</p></li>
<li><p><strong>master_grad</strong> – gradient of a single ncs copy (the master copy)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.lbfgs">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization_ncs_constraints.</span></span><span class="sig-name descname"><span class="pre">lbfgs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncs_restraints_group_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_and_grads_object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_grad_differences_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_grad_difference_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_u_iso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_transformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.lbfgs.compute_functional_and_gradients">
<span class="sig-name descname"><span class="pre">compute_functional_and_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.compute_functional_and_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.lbfgs.finite_difference_test">
<span class="sig-name descname"><span class="pre">finite_difference_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">g</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.finite_difference_test" title="Link to this definition">¶</a></dt>
<dd><p>Compare analytical and finite differences gradients.</p>
<p>finite_grad_difference_val = abs(analytical - finite differences)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.lbfgs.refinable_params_one_ncs_to_asu">
<span class="sig-name descname"><span class="pre">refinable_params_one_ncs_to_asu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.refinable_params_one_ncs_to_asu" title="Link to this definition">¶</a></dt>
<dd><p>Expand refinabale parameters corresponding to one NCS copy to parameters
corresponding to whole ASU.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.lbfgs.update_xray_structure">
<span class="sig-name descname"><span class="pre">update_xray_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.update_xray_structure" title="Link to this definition">¶</a></dt>
<dd><p>Update xray_structure with refined parameters, then update
fmodel object with updated xray_structure.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.restraints_target_and_grads">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization_ncs_constraints.</span></span><span class="sig-name descname"><span class="pre">restraints_target_and_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ncs_restraints_group_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_u_iso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_transformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iso_restraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_hd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.restraints_target_and_grads" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncs_restraints_group_list</strong> – NCS operator list</p></li>
<li><p><strong>restraints_manager</strong> – (object)</p></li>
<li><p><strong>xray_structure</strong> – (object)</p></li>
<li><p><strong>grad</strong> – gradient without restraints</p></li>
<li><p><strong>x</strong> – refined parameter</p></li>
<li><p><strong>refine_sites</strong> – (bool) indicate refinement type</p></li>
<li><p><strong>refine_u_iso</strong> – (bool) indicate refinement type</p></li>
<li><p><strong>refine_transformations</strong> – (bool) indicate refinement type</p></li>
<li><p><strong>iso_restraints</strong> – (object) iso restraints parameters</p></li>
<li><p><strong>use_hd</strong> – (bool) Use hydrogen</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(float) restraints target function value
ef_grad: (flex.double or flex.vec3_double) restraints gradient</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ef_target</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization_ncs_constraints.</span></span><span class="sig-name descname"><span class="pre">target_function_and_grads_geometry_minimization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncs_restraints_group_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ncs_constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_transformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Target and gradients evaluator for geometry minimization (no data)</p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization.target_and_gradients">
<span class="sig-name descname"><span class="pre">target_and_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization.target_and_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization_ncs_constraints.</span></span><span class="sig-name descname"><span class="pre">target_function_and_grads_real_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">map_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncs_restraints_group_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_space_gradients_delta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ncs_constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Real-space target and gradients evaluator</p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.data_target_and_grads">
<span class="sig-name descname"><span class="pre">data_target_and_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.data_target_and_grads" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compute_gradients</strong> – (bool) when True compute gradients</p></li>
<li><p><strong>x</strong> – refined parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.target_and_gradients">
<span class="sig-name descname"><span class="pre">target_and_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.target_and_gradients" title="Link to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compute_gradients</strong> – (bool) when True compute gradients</p></li>
<li><p><strong>xray_structure</strong> – xray_structure object</p></li>
<li><p><strong>x</strong> – refined parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.minimization_ncs_constraints.</span></span><span class="sig-name descname"><span class="pre">target_function_and_grads_reciprocal_space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncs_restraints_group_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ncs_constraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints_manager</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_u_iso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_transformations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iso_restraints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_hd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Reciprocal-space target and gradients evaluator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>refine_selection</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.size_t" title="scitbx.array_family.flex.size_t"><em>flex.size_t</em></a>) – of all ncs related copies and
non ncs related parts to be refined</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.data_target_and_grads">
<span class="sig-name descname"><span class="pre">data_target_and_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.data_target_and_grads" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.finalize" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.target_and_gradients">
<span class="sig-name descname"><span class="pre">target_and_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.target_and_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="mmtbx-refinement-occupancies-module">
<h2>mmtbx.refinement.occupancies module<a class="headerlink" href="#mmtbx-refinement-occupancies-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.occupancies">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.add_occupancy_selection">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">add_occupancy_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selection</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hd_special</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.add_occupancy_selection" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.assemble_constraint_groups_3d">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">assemble_constraint_groups_3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdb_atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraint_groups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction_distance_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.assemble_constraint_groups_3d" title="Link to this definition">¶</a></dt>
<dd><p>Re-sorts occupancy constraint groups so that conformers whose motion is
correlated (i.e. they interact in 3D, without necessarily being part of
the same fragment/molecule/ASU) are grouped together.  As input, it expects
the constraint groups output by mmtbx.utils.occupancy_selections(), which
will already have connectivity taken into account.  This function will exit
with an error if the occupancies for the new groups are not consistent.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.extract_partial_occupancy_selections">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">extract_partial_occupancy_selections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hierarchy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.extract_partial_occupancy_selections" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.list_3d_as_bool_selection">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">list_3d_as_bool_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_3d</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.list_3d_as_bool_selection" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.manager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_macro_cycles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_hd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.manager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.manager.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">message</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.manager.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.manager.show_helper">
<span class="sig-name descname"><span class="pre">show_helper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.manager.show_helper" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.minimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">minimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrained_groups_selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">par_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_number_of_iterations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.minimizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.minimizer.compute_functional_and_gradients">
<span class="sig-name descname"><span class="pre">compute_functional_and_gradients</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.minimizer.compute_functional_and_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.minimizer.pack">
<span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.minimizer.pack" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.minimizer.unpack_x">
<span class="sig-name descname"><span class="pre">unpack_x</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.minimizer.unpack_x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.occupancy_regroupping">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">occupancy_regroupping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_hierarchy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cgs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.occupancy_regroupping" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.occupancy_selections">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">occupancy_selections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_water</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_individual_selection_strings</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">other_constrained_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">as_flex_arrays</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constrain_correlated_3d_groups</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.occupancy_selections" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.pack_gradients">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">pack_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.pack_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.pack_unpack">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">pack_unpack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.pack_unpack" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.occupancies.set_refinable_parameters">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.occupancies.</span></span><span class="sig-name descname"><span class="pre">set_refinable_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enforce_positivity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.set_refinable_parameters" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="mmtbx-refinement-orca-module">
<h2>mmtbx.refinement.orca module<a class="headerlink" href="#mmtbx-refinement-orca-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.orca">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.average_sites_cart">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">average_sites_cart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">related_x_i_seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_sites_cart</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.average_sites_cart" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">expand</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">masses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geo_manager</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand.rmsd_calculation">
<span class="sig-name descname"><span class="pre">rmsd_calculation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites_cart_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_cart_2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand.rmsd_calculation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand.rmsd_calculator">
<span class="sig-name descname"><span class="pre">rmsd_calculator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tardy_tree_rmsd_calculator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand.rmsd_calculator" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand_angle_proxies">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">expand_angle_proxies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle_proxies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_n_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">related_x_i_seqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_angle_proxies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand_bond_params_table">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">expand_bond_params_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_params_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_n_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">related_x_i_seqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_bond_params_table" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand_dihedral_or_chirality_proxies">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">expand_dihedral_or_chirality_proxies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proxies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy_array_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_n_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">related_x_i_seqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_dihedral_or_chirality_proxies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand_model_or_conformer_indices">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">expand_model_or_conformer_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_n_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">related_x_i_seqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_model_or_conformer_indices" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand_nonbonded_types">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">expand_nonbonded_types</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nonbonded_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_n_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">related_x_i_seqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_nonbonded_types" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand_pair_sym_table">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">expand_pair_sym_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pair_sym_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_n_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">related_x_i_seqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_pair_sym_table" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand_planarity_proxies">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">expand_planarity_proxies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">planarity_proxies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_n_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">related_x_i_seqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_planarity_proxies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.orca.expand_site_symmetry_table">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.orca.</span></span><span class="sig-name descname"><span class="pre">expand_site_symmetry_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">site_symmetry_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_n_seq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">related_x_i_seqs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_site_symmetry_table" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="mmtbx-refinement-print-statistics-module">
<h2>mmtbx.refinement.print_statistics module<a class="headerlink" href="#mmtbx-refinement-print-statistics-module" title="Link to this heading">¶</a></h2>
<dl class="py class" id="module-mmtbx.refinement.print_statistics">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.annealing_callback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">annealing_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.annealing_callback" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.coordinate_shifts">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">coordinate_shifts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hierarchy_start</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hierarchy_end</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.coordinate_shifts" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.coordinate_shifts.get_shifts">
<span class="sig-name descname"><span class="pre">get_shifts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.coordinate_shifts.get_shifts" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.coordinate_shifts.min_max_mean">
<span class="sig-name descname"><span class="pre">min_max_mean</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.coordinate_shifts.min_max_mean" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.coordinate_shifts.save_pdb_file">
<span class="sig-name descname"><span class="pre">save_pdb_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.coordinate_shifts.save_pdb_file" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.macro_cycle_header">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">macro_cycle_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">macro_cycle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_macro_cycles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.macro_cycle_header" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.make_header">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">make_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">line</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.make_header" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.make_sub_header">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">make_sub_header</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.make_sub_header" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.refinement_monitor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">refinement_monitor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neutron_refinement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_back_handler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_neutron_monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.refinement_monitor.call_back">
<span class="sig-name descname"><span class="pre">call_back</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'monitor_collect'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.call_back" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.refinement_monitor.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wilson_b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rigid_body_shift_accumulator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.collect" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.refinement_monitor.dump_statistics">
<span class="sig-name descname"><span class="pre">dump_statistics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.dump_statistics" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.refinement_monitor.format_stats_for_phenix_gui">
<span class="sig-name descname"><span class="pre">format_stats_for_phenix_gui</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.format_stats_for_phenix_gui" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.refinement_monitor.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.refinement_monitor.show_current_r_factors_summary">
<span class="sig-name descname"><span class="pre">show_current_r_factors_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.show_current_r_factors_summary" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.show_process_info">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">show_process_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.show_process_info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.show_rigid_body_rotations_and_translations">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">show_rigid_body_rotations_and_translations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">euler_angle_convention</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.show_rigid_body_rotations_and_translations" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.show_times">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">show_times</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.show_times" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.stats_table">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">stats_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../libtbx/index.html#libtbx.slots_getstate_setstate" title="libtbx.slots_getstate_setstate"><code class="xref py py-class docutils literal notranslate"><span class="pre">slots_getstate_setstate</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.stats_table.as_ave">
<span class="sig-name descname"><span class="pre">as_ave</span></span><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.as_ave" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.stats_table.bs_ave">
<span class="sig-name descname"><span class="pre">bs_ave</span></span><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.bs_ave" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.stats_table.neutron_flag">
<span class="sig-name descname"><span class="pre">neutron_flag</span></span><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.neutron_flag" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.stats_table.r_frees">
<span class="sig-name descname"><span class="pre">r_frees</span></span><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.r_frees" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.stats_table.r_works">
<span class="sig-name descname"><span class="pre">r_works</span></span><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.r_works" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.stats_table.steps">
<span class="sig-name descname"><span class="pre">steps</span></span><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.steps" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.print_statistics.trajectory_output">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.print_statistics.</span></span><span class="sig-name descname"><span class="pre">trajectory_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_base='refine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filled_maps=True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.trajectory_output" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Callback object for saving the intermediate results of refinement as a stack
of PDB and MTZ files.  Equivalent to the interactivity with Coot in the
Phenix GUI, but intended for command-line use and demonstrative purposes.</p>
</dd></dl>

</section>
<section id="mmtbx-refinement-refinement-flags-module">
<h2>mmtbx.refinement.refinement_flags module<a class="headerlink" href="#mmtbx-refinement-refinement-flags-module" title="Link to this heading">¶</a></h2>
<dl class="py class" id="module-mmtbx.refinement.refinement_flags">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.refinement_flags.</span></span><span class="sig-name descname"><span class="pre">manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">individual_sites</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torsion_angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rigid_body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">individual_adp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_adp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_anomalous</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_individual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_torsion_angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_rigid_body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_individual_iso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_individual_aniso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_tls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_occupancies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">next_to_i_seqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_individual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_torsion_angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_rigid_body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_individual_iso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_individual_aniso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_tls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_occupancies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.add" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.ca">
<span class="sig-name descname"><span class="pre">ca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.ca" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.check_all">
<span class="sig-name descname"><span class="pre">check_all</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.check_all" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.count_occupancies">
<span class="sig-name descname"><span class="pre">count_occupancies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.count_occupancies" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.deep_copy">
<span class="sig-name descname"><span class="pre">deep_copy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.deep_copy" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.inflate">
<span class="sig-name descname"><span class="pre">inflate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites_individual</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_torsion_angles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_rigid_body</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_individual_iso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_individual_aniso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_h</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_tls</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">s_occupancies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancies_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size_all</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.inflate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.is_bool">
<span class="sig-name descname"><span class="pre">is_bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.is_bool" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.is_size_t">
<span class="sig-name descname"><span class="pre">is_size_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.is_size_t" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.select">
<span class="sig-name descname"><span class="pre">select</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.select" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.select_detached">
<span class="sig-name descname"><span class="pre">select_detached</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.select_detached" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.refinement_flags.manager.szs">
<span class="sig-name descname"><span class="pre">szs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.szs" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="mmtbx-refinement-rigid-body-module">
<h2>mmtbx.refinement.rigid_body module<a class="headerlink" href="#mmtbx-refinement-rigid-body-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.rigid_body">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.apply_transformation">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.rigid_body.</span></span><span class="sig-name descname"><span class="pre">apply_transformation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_matrices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translation_vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.apply_transformation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.apply_transformation_">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.rigid_body.</span></span><span class="sig-name descname"><span class="pre">apply_transformation_</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rotation_matrices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translation_vectors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atomic_weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.apply_transformation_" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.manager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.rigid_body.</span></span><span class="sig-name descname"><span class="pre">manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_initial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.manager.evaluate_after_end">
<span class="sig-name descname"><span class="pre">evaluate_after_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_r_work</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_r_free</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager.evaluate_after_end" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.manager.rotation">
<span class="sig-name descname"><span class="pre">rotation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager.rotation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.manager.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_vec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.manager.translation">
<span class="sig-name descname"><span class="pre">translation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager.translation" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.rigid_body_minimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.rigid_body.</span></span><span class="sig-name descname"><span class="pre">rigid_body_minimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_initial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine_t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iterations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">euler_angle_convention</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lbfgs_maxfev</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.rigid_body_minimizer.compute_functional_and_gradients">
<span class="sig-name descname"><span class="pre">compute_functional_and_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">suppress_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer.compute_functional_and_gradients" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.rigid_body_minimizer.pack">
<span class="sig-name descname"><span class="pre">pack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer.pack" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.rigid_body_minimizer.unpack_x">
<span class="sig-name descname"><span class="pre">unpack_x</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer.unpack_x" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.rigid_body_shift_accumulator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.rigid_body.</span></span><span class="sig-name descname"><span class="pre">rigid_body_shift_accumulator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">euler_angle_convention</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_shift_accumulator" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rotations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translations</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.add" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.rigid_groups_from_pdb_chains">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.rigid_body.</span></span><span class="sig-name descname"><span class="pre">rigid_groups_from_pdb_chains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_hierarchy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_chain_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_for_atoms_on_special_positions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">group_all_by_chain</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_groups_from_pdb_chains" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.split_resolution_range">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.rigid_body.</span></span><span class="sig-name descname"><span class="pre">split_resolution_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d_spacings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bodies</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_auto_switch_resolution</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_ref_first</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_body_factor_n_ref_first</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_zones</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zone_exponent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.split_resolution_range" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.target_and_grads">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.rigid_body.</span></span><span class="sig-name descname"><span class="pre">target_and_grads</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centers_of_mass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sites_cart</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_functor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rot_objs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selections</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suppress_gradients</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.target_and_grads" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_r">
<span class="sig-name descname"><span class="pre">gradients_wrt_r</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_r" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_t">
<span class="sig-name descname"><span class="pre">gradients_wrt_t</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_t" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.rigid_body.target_and_grads.target">
<span class="sig-name descname"><span class="pre">target</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.target_and_grads.target" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="mmtbx-refinement-select-best-starting-model-module">
<h2>mmtbx.refinement.select_best_starting_model module<a class="headerlink" href="#mmtbx-refinement-select-best-starting-model-module" title="Link to this heading">¶</a></h2>
<p id="module-mmtbx.refinement.select_best_starting_model">This module provides a way to identify a suitably isomorphous initial model
for directly refining against experimental data.  This is commonly done when
solving a series of ligand-bound structures, partly to save time, and partly
to avoid changing the frame of reference when running molecular replacement.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.evaluate_model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.select_best_starting_model.</span></span><span class="sig-name descname"><span class="pre">evaluate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdb_hierarchy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_free_flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rigid_body_refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimize_b_factors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_twin_detection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scattering_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'n_gaussian'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../libtbx/index.html#libtbx.slots_getstate_setstate" title="libtbx.slots_getstate_setstate"><code class="xref py py-class docutils literal notranslate"><span class="pre">slots_getstate_setstate</span></code></a></p>
<p>Create an fmodel object (including bulk solvent correction) and calculate
R-factors, with or without optional rigid-body refinement.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.evaluate_model.r_free">
<span class="sig-name descname"><span class="pre">r_free</span></span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_free" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.evaluate_model.r_free_start">
<span class="sig-name descname"><span class="pre">r_free_start</span></span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_free_start" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.evaluate_model.r_work">
<span class="sig-name descname"><span class="pre">r_work</span></span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_work" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.evaluate_model.r_work_start">
<span class="sig-name descname"><span class="pre">r_work_start</span></span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_work_start" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.evaluate_model.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix=''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.evaluate_model.xray_structure">
<span class="sig-name descname"><span class="pre">xray_structure</span></span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.xray_structure" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.select_best_starting_model.</span></span><span class="sig-name descname"><span class="pre">select_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_free_flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_twin_detection=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nproc=1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model.evaluate_model">
<span class="sig-name descname"><span class="pre">evaluate_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.evaluate_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model.get_best_model">
<span class="sig-name descname"><span class="pre">get_best_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">update_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.get_best_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model.r_free">
<span class="sig-name descname"><span class="pre">r_free</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.r_free" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model.r_work">
<span class="sig-name descname"><span class="pre">r_work</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.r_work" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model.save_best_model">
<span class="sig-name descname"><span class="pre">save_best_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best_model.pdb'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.save_best_model" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model.save_updated_data">
<span class="sig-name descname"><span class="pre">save_updated_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'best_model_data.mtz'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.save_updated_data" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model.show">
<span class="sig-name descname"><span class="pre">show</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out=&lt;_io.TextIOWrapper</span> <span class="pre">name='&lt;stdout&gt;'</span> <span class="pre">mode='w'</span> <span class="pre">encoding='utf-8'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose=False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.show" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model.space_group_info">
<span class="sig-name descname"><span class="pre">space_group_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.space_group_info" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.select_model.success">
<span class="sig-name descname"><span class="pre">success</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.success" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.strip_model">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.select_best_starting_model.</span></span><span class="sig-name descname"><span class="pre">strip_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_hierarchy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_waters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_hydrogens</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_alt_confs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_semet_to_met</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convert_to_isotropic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_occupancies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_ligands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reset_hetatm_flag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_remarks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preserve_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_remarks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.strip_model" title="Link to this definition">¶</a></dt>
<dd><p>Utility for removing extraneous records from a model intended for use in
molecular replacement, etc., including waters, alternate conformations,
and other features specific to a particular dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.select_best_starting_model.ucf">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.select_best_starting_model.</span></span><span class="sig-name descname"><span class="pre">ucf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit_cell</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.ucf" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="mmtbx-refinement-tardy-module">
<h2>mmtbx.refinement.tardy module<a class="headerlink" href="#mmtbx-refinement-tardy-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.tardy">
<dt class="sig sig-object py" id="mmtbx.refinement.tardy.action">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.tardy.</span></span><span class="sig-name descname"><span class="pre">action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tardy_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rmsd_calculator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_for_phenix_refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.action" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.tardy.potential_object">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.tardy.</span></span><span class="sig-name descname"><span class="pre">potential_object</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xray_weight_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prolsq_repulsion_function_changes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduced_geo_manager</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.potential_object" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.tardy.potential_object.crystal_symmetry">
<span class="sig-name descname"><span class="pre">crystal_symmetry</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.potential_object.crystal_symmetry" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.tardy.potential_object.d_e_pot_d_sites">
<span class="sig-name descname"><span class="pre">d_e_pot_d_sites</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites_moved</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.potential_object.d_e_pot_d_sites" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.tardy.potential_object.e_pot">
<span class="sig-name descname"><span class="pre">e_pot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sites_moved</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.potential_object.e_pot" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.tardy.run">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.tardy.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format_for_phenix_refine</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_back_after_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.run" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="mmtbx-refinement-targets-module">
<h2>mmtbx.refinement.targets module<a class="headerlink" href="#mmtbx-refinement-targets-module" title="Link to this heading">¶</a></h2>
<dl class="py function" id="module-mmtbx.refinement.targets">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.ls_ff_weights">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.targets.</span></span><span class="sig-name descname"><span class="pre">ls_ff_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">B</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.ls_ff_weights" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.ls_sigma_weights">
<span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.targets.</span></span><span class="sig-name descname"><span class="pre">ls_sigma_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_obs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.ls_sigma_weights" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.phaser_sad_target_functor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.targets.</span></span><span class="sig-name descname"><span class="pre">phaser_sad_target_functor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_free_flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xray_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_calc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_memory</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.phaser_sad_target_functor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.phaser_sad_target_functor.prepare_for_minimization">
<span class="sig-name descname"><span class="pre">prepare_for_minimization</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.phaser_sad_target_functor.prepare_for_minimization" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.phaser_sad_target_functor.target_memory">
<span class="sig-name descname"><span class="pre">target_memory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.phaser_sad_target_functor.target_memory" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_attributes">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.targets.</span></span><span class="sig-name descname"><span class="pre">target_attributes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">family</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">specialization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_attributes" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_attributes.requires_experimental_phases">
<span class="sig-name descname"><span class="pre">requires_experimental_phases</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_attributes.requires_experimental_phases" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_attributes.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_attributes.validate" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_functor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.targets.</span></span><span class="sig-name descname"><span class="pre">target_functor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_functor" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_functor.prepare_for_minimization">
<span class="sig-name descname"><span class="pre">prepare_for_minimization</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_functor.prepare_for_minimization" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_functor.target_function_is_invariant_under_allowed_origin_shifts">
<span class="sig-name descname"><span class="pre">target_function_is_invariant_under_allowed_origin_shifts</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_functor.target_function_is_invariant_under_allowed_origin_shifts" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_result">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.targets.</span></span><span class="sig-name descname"><span class="pre">target_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">manager</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">core_result</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mmtbx.refinement.targets.target_result_mixin" title="mmtbx.refinement.targets.target_result_mixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">target_result_mixin</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_result.d_target_d_f_calc_work">
<span class="sig-name descname"><span class="pre">d_target_d_f_calc_work</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.d_target_d_f_calc_work" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_result.d_target_d_f_model_work">
<span class="sig-name descname"><span class="pre">d_target_d_f_model_work</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.d_target_d_f_model_work" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_result.target_per_reflection">
<span class="sig-name descname"><span class="pre">target_per_reflection</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.target_per_reflection" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_result.target_test">
<span class="sig-name descname"><span class="pre">target_test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.target_test" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_result.target_work">
<span class="sig-name descname"><span class="pre">target_work</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.target_work" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_result_mixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.targets.</span></span><span class="sig-name descname"><span class="pre">target_result_mixin</span></span><a class="headerlink" href="#mmtbx.refinement.targets.target_result_mixin" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_result_mixin.d_target_d_site_cart">
<span class="sig-name descname"><span class="pre">d_target_d_site_cart</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result_mixin.d_target_d_site_cart" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.targets.target_result_mixin.gradients_wrt_atomic_parameters">
<span class="sig-name descname"><span class="pre">gradients_wrt_atomic_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">site</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_iso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_aniso</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tan_b_iso_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_iso_refinable_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result_mixin.gradients_wrt_atomic_parameters" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="mmtbx-refinement-weights-params-module">
<h2>mmtbx.refinement.weights_params module<a class="headerlink" href="#mmtbx-refinement-weights-params-module" title="Link to this heading">¶</a></h2>
</section>
<section id="mmtbx-refinement-wx-tardy-pdb-module">
<span id="module-mmtbx.refinement.weights_params"></span><h2>mmtbx.refinement.wx_tardy_pdb module<a class="headerlink" href="#mmtbx-refinement-wx-tardy-pdb-module" title="Link to this heading">¶</a></h2>
</section>
<section id="module-contents">
<h2>Module contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<dl class="py class" id="module-mmtbx.refinement">
<dt class="sig sig-object py" id="mmtbx.refinement.monitors">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mmtbx.refinement.</span></span><span class="sig-name descname"><span class="pre">monitors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neutron_refinement</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">call_back_handler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.monitors" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="mmtbx.refinement.monitors.collect">
<span class="sig-name descname"><span class="pre">collect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmodels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rigid_body_shift_accumulator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.monitors.collect" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">mmtbx.refinement package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#mmtbx-refinement-adp-refinement-module">mmtbx.refinement.adp_refinement module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.manager"><code class="docutils literal notranslate"><span class="pre">manager</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.refine_adp"><code class="docutils literal notranslate"><span class="pre">refine_adp</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.refine_adp.minimize"><code class="docutils literal notranslate"><span class="pre">refine_adp.minimize()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.refine_adp.run_lbfgs"><code class="docutils literal notranslate"><span class="pre">refine_adp.run_lbfgs()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.refine_adp.score"><code class="docutils literal notranslate"><span class="pre">refine_adp.score()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.refine_adp.select"><code class="docutils literal notranslate"><span class="pre">refine_adp.select()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.refine_adp.show"><code class="docutils literal notranslate"><span class="pre">refine_adp.show()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.refine_adp.try_weight"><code class="docutils literal notranslate"><span class="pre">refine_adp.try_weight()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.show_times"><code class="docutils literal notranslate"><span class="pre">show_times()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.weight_result"><code class="docutils literal notranslate"><span class="pre">weight_result</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.adp_refinement.weight_result.show"><code class="docutils literal notranslate"><span class="pre">weight_result.show()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-anomalous-scatterer-groups-module">mmtbx.refinement.anomalous_scatterer_groups module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.anomalous_scatterer_groups.find_anomalous_scatterer_groups"><code class="docutils literal notranslate"><span class="pre">find_anomalous_scatterer_groups()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.anomalous_scatterer_groups.get_single_atom_selection_string"><code class="docutils literal notranslate"><span class="pre">get_single_atom_selection_string()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.anomalous_scatterer_groups.minimizer"><code class="docutils literal notranslate"><span class="pre">minimizer</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.anomalous_scatterer_groups.minimizer.compute_functional_and_gradients"><code class="docutils literal notranslate"><span class="pre">minimizer.compute_functional_and_gradients()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.anomalous_scatterer_groups.minimizer.unpack"><code class="docutils literal notranslate"><span class="pre">minimizer.unpack()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.anomalous_scatterer_groups.refine_anomalous_substructure"><code class="docutils literal notranslate"><span class="pre">refine_anomalous_substructure()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-fit-rotamers-module">mmtbx.refinement.fit_rotamers module</a></li>
<li><a class="reference internal" href="#mmtbx-refinement-flip-peptides-module">mmtbx.refinement.flip_peptides module</a></li>
<li><a class="reference internal" href="#mmtbx-refinement-geometry-minimization-module">mmtbx.refinement.geometry_minimization module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.geometry_minimization.add_rotamer_restraints"><code class="docutils literal notranslate"><span class="pre">add_rotamer_restraints()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.geometry_minimization.lbfgs"><code class="docutils literal notranslate"><span class="pre">lbfgs</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.geometry_minimization.lbfgs.callback_after_step"><code class="docutils literal notranslate"><span class="pre">lbfgs.callback_after_step()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.geometry_minimization.minimize_wrapper_for_ramachandran"><code class="docutils literal notranslate"><span class="pre">minimize_wrapper_for_ramachandran()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.geometry_minimization.run2"><code class="docutils literal notranslate"><span class="pre">run2</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.geometry_minimization.run2.show"><code class="docutils literal notranslate"><span class="pre">run2.show()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.geometry_minimization.run2.update_cdl_restraints"><code class="docutils literal notranslate"><span class="pre">run2.update_cdl_restraints()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.geometry_minimization.run2.updaterdl"><code class="docutils literal notranslate"><span class="pre">run2.updaterdl()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-group-module">mmtbx.refinement.group module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.group.apply_transformation"><code class="docutils literal notranslate"><span class="pre">apply_transformation()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.group.group_minimizer"><code class="docutils literal notranslate"><span class="pre">group_minimizer</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.group.group_minimizer.apply_shifts"><code class="docutils literal notranslate"><span class="pre">group_minimizer.apply_shifts()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.group.group_minimizer.compute_functional_and_gradients"><code class="docutils literal notranslate"><span class="pre">group_minimizer.compute_functional_and_gradients()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.group.group_minimizer.finite_difference_test"><code class="docutils literal notranslate"><span class="pre">group_minimizer.finite_difference_test()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.group.group_minimizer.get_restraints_tg"><code class="docutils literal notranslate"><span class="pre">group_minimizer.get_restraints_tg()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.group.group_minimizer.get_tg"><code class="docutils literal notranslate"><span class="pre">group_minimizer.get_tg()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.group.group_minimizer.pack"><code class="docutils literal notranslate"><span class="pre">group_minimizer.pack()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.group.group_minimizer.unpack_x"><code class="docutils literal notranslate"><span class="pre">group_minimizer.unpack_x()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.group.manager"><code class="docutils literal notranslate"><span class="pre">manager</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.group.manager.show"><code class="docutils literal notranslate"><span class="pre">manager.show()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.group.show_times"><code class="docutils literal notranslate"><span class="pre">show_times()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.group.sphere_similarity_restraints"><code class="docutils literal notranslate"><span class="pre">sphere_similarity_restraints</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.group.sphere_similarity_restraints.target_and_gradients"><code class="docutils literal notranslate"><span class="pre">sphere_similarity_restraints.target_and_gradients()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.group.target_and_grads"><code class="docutils literal notranslate"><span class="pre">target_and_grads</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.group.target_and_grads.gradients_wrt_par"><code class="docutils literal notranslate"><span class="pre">target_and_grads.gradients_wrt_par()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.group.target_and_grads.target"><code class="docutils literal notranslate"><span class="pre">target_and_grads.target()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-inspect-tardy-trajectory-module">mmtbx.refinement.inspect_tardy_trajectory module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.inspect_tardy_trajectory.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-minimization-module">mmtbx.refinement.minimization module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.lbfgs"><code class="docutils literal notranslate"><span class="pre">lbfgs</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.lbfgs.apply_shifts"><code class="docutils literal notranslate"><span class="pre">lbfgs.apply_shifts()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.lbfgs.callback_after_step"><code class="docutils literal notranslate"><span class="pre">lbfgs.callback_after_step()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.lbfgs.compute_functional_and_gradients"><code class="docutils literal notranslate"><span class="pre">lbfgs.compute_functional_and_gradients()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.lbfgs.compute_target"><code class="docutils literal notranslate"><span class="pre">lbfgs.compute_target()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.monitor"><code class="docutils literal notranslate"><span class="pre">monitor</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.monitor.collect"><code class="docutils literal notranslate"><span class="pre">monitor.collect()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.monitor.neutron_line"><code class="docutils literal notranslate"><span class="pre">monitor.neutron_line()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.monitor.show"><code class="docutils literal notranslate"><span class="pre">monitor.show()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.monitor.xray_line"><code class="docutils literal notranslate"><span class="pre">monitor.xray_line()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization.run_constrained"><code class="docutils literal notranslate"><span class="pre">run_constrained</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-minimization-ncs-constraints-module">mmtbx.refinement.minimization_ncs_constraints module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.grads_asu_to_one_ncs"><code class="docutils literal notranslate"><span class="pre">grads_asu_to_one_ncs()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.grads_one_ncs_to_asu"><code class="docutils literal notranslate"><span class="pre">grads_one_ncs_to_asu()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs"><code class="docutils literal notranslate"><span class="pre">lbfgs</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.compute_functional_and_gradients"><code class="docutils literal notranslate"><span class="pre">lbfgs.compute_functional_and_gradients()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.finite_difference_test"><code class="docutils literal notranslate"><span class="pre">lbfgs.finite_difference_test()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.refinable_params_one_ncs_to_asu"><code class="docutils literal notranslate"><span class="pre">lbfgs.refinable_params_one_ncs_to_asu()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.update_xray_structure"><code class="docutils literal notranslate"><span class="pre">lbfgs.update_xray_structure()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.restraints_target_and_grads"><code class="docutils literal notranslate"><span class="pre">restraints_target_and_grads()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization"><code class="docutils literal notranslate"><span class="pre">target_function_and_grads_geometry_minimization</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization.target_and_gradients"><code class="docutils literal notranslate"><span class="pre">target_function_and_grads_geometry_minimization.target_and_gradients()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space"><code class="docutils literal notranslate"><span class="pre">target_function_and_grads_real_space</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.data_target_and_grads"><code class="docutils literal notranslate"><span class="pre">target_function_and_grads_real_space.data_target_and_grads()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.target_and_gradients"><code class="docutils literal notranslate"><span class="pre">target_function_and_grads_real_space.target_and_gradients()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space"><code class="docutils literal notranslate"><span class="pre">target_function_and_grads_reciprocal_space</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.data_target_and_grads"><code class="docutils literal notranslate"><span class="pre">target_function_and_grads_reciprocal_space.data_target_and_grads()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.finalize"><code class="docutils literal notranslate"><span class="pre">target_function_and_grads_reciprocal_space.finalize()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.target_and_gradients"><code class="docutils literal notranslate"><span class="pre">target_function_and_grads_reciprocal_space.target_and_gradients()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-occupancies-module">mmtbx.refinement.occupancies module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.add_occupancy_selection"><code class="docutils literal notranslate"><span class="pre">add_occupancy_selection()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.assemble_constraint_groups_3d"><code class="docutils literal notranslate"><span class="pre">assemble_constraint_groups_3d()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.extract_partial_occupancy_selections"><code class="docutils literal notranslate"><span class="pre">extract_partial_occupancy_selections()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.list_3d_as_bool_selection"><code class="docutils literal notranslate"><span class="pre">list_3d_as_bool_selection()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.manager"><code class="docutils literal notranslate"><span class="pre">manager</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.manager.show"><code class="docutils literal notranslate"><span class="pre">manager.show()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.manager.show_helper"><code class="docutils literal notranslate"><span class="pre">manager.show_helper()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.minimizer"><code class="docutils literal notranslate"><span class="pre">minimizer</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.minimizer.compute_functional_and_gradients"><code class="docutils literal notranslate"><span class="pre">minimizer.compute_functional_and_gradients()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.minimizer.pack"><code class="docutils literal notranslate"><span class="pre">minimizer.pack()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.minimizer.unpack_x"><code class="docutils literal notranslate"><span class="pre">minimizer.unpack_x()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.occupancy_regroupping"><code class="docutils literal notranslate"><span class="pre">occupancy_regroupping()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.occupancy_selections"><code class="docutils literal notranslate"><span class="pre">occupancy_selections()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.pack_gradients"><code class="docutils literal notranslate"><span class="pre">pack_gradients()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.pack_unpack"><code class="docutils literal notranslate"><span class="pre">pack_unpack()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.occupancies.set_refinable_parameters"><code class="docutils literal notranslate"><span class="pre">set_refinable_parameters()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-orca-module">mmtbx.refinement.orca module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.orca.average_sites_cart"><code class="docutils literal notranslate"><span class="pre">average_sites_cart()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand"><code class="docutils literal notranslate"><span class="pre">expand</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand.rmsd_calculation"><code class="docutils literal notranslate"><span class="pre">expand.rmsd_calculation()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand.rmsd_calculator"><code class="docutils literal notranslate"><span class="pre">expand.rmsd_calculator()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand_angle_proxies"><code class="docutils literal notranslate"><span class="pre">expand_angle_proxies()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand_bond_params_table"><code class="docutils literal notranslate"><span class="pre">expand_bond_params_table()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand_dihedral_or_chirality_proxies"><code class="docutils literal notranslate"><span class="pre">expand_dihedral_or_chirality_proxies()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand_model_or_conformer_indices"><code class="docutils literal notranslate"><span class="pre">expand_model_or_conformer_indices()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand_nonbonded_types"><code class="docutils literal notranslate"><span class="pre">expand_nonbonded_types()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand_pair_sym_table"><code class="docutils literal notranslate"><span class="pre">expand_pair_sym_table()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand_planarity_proxies"><code class="docutils literal notranslate"><span class="pre">expand_planarity_proxies()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.orca.expand_site_symmetry_table"><code class="docutils literal notranslate"><span class="pre">expand_site_symmetry_table()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-print-statistics-module">mmtbx.refinement.print_statistics module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.annealing_callback"><code class="docutils literal notranslate"><span class="pre">annealing_callback</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.coordinate_shifts"><code class="docutils literal notranslate"><span class="pre">coordinate_shifts</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.coordinate_shifts.get_shifts"><code class="docutils literal notranslate"><span class="pre">coordinate_shifts.get_shifts()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.coordinate_shifts.min_max_mean"><code class="docutils literal notranslate"><span class="pre">coordinate_shifts.min_max_mean()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.coordinate_shifts.save_pdb_file"><code class="docutils literal notranslate"><span class="pre">coordinate_shifts.save_pdb_file()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.macro_cycle_header"><code class="docutils literal notranslate"><span class="pre">macro_cycle_header()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.make_header"><code class="docutils literal notranslate"><span class="pre">make_header()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.make_sub_header"><code class="docutils literal notranslate"><span class="pre">make_sub_header()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.refinement_monitor"><code class="docutils literal notranslate"><span class="pre">refinement_monitor</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.refinement_monitor.call_back"><code class="docutils literal notranslate"><span class="pre">refinement_monitor.call_back()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.refinement_monitor.collect"><code class="docutils literal notranslate"><span class="pre">refinement_monitor.collect()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.refinement_monitor.dump_statistics"><code class="docutils literal notranslate"><span class="pre">refinement_monitor.dump_statistics()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.refinement_monitor.format_stats_for_phenix_gui"><code class="docutils literal notranslate"><span class="pre">refinement_monitor.format_stats_for_phenix_gui()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.refinement_monitor.show"><code class="docutils literal notranslate"><span class="pre">refinement_monitor.show()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.refinement_monitor.show_current_r_factors_summary"><code class="docutils literal notranslate"><span class="pre">refinement_monitor.show_current_r_factors_summary()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.show_process_info"><code class="docutils literal notranslate"><span class="pre">show_process_info()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.show_rigid_body_rotations_and_translations"><code class="docutils literal notranslate"><span class="pre">show_rigid_body_rotations_and_translations()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.show_times"><code class="docutils literal notranslate"><span class="pre">show_times()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.stats_table"><code class="docutils literal notranslate"><span class="pre">stats_table</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.stats_table.as_ave"><code class="docutils literal notranslate"><span class="pre">stats_table.as_ave</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.stats_table.bs_ave"><code class="docutils literal notranslate"><span class="pre">stats_table.bs_ave</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.stats_table.neutron_flag"><code class="docutils literal notranslate"><span class="pre">stats_table.neutron_flag</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.stats_table.r_frees"><code class="docutils literal notranslate"><span class="pre">stats_table.r_frees</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.stats_table.r_works"><code class="docutils literal notranslate"><span class="pre">stats_table.r_works</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.stats_table.steps"><code class="docutils literal notranslate"><span class="pre">stats_table.steps</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.print_statistics.trajectory_output"><code class="docutils literal notranslate"><span class="pre">trajectory_output</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-refinement-flags-module">mmtbx.refinement.refinement_flags module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager"><code class="docutils literal notranslate"><span class="pre">manager</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.add"><code class="docutils literal notranslate"><span class="pre">manager.add()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.ca"><code class="docutils literal notranslate"><span class="pre">manager.ca()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.check_all"><code class="docutils literal notranslate"><span class="pre">manager.check_all()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.count_occupancies"><code class="docutils literal notranslate"><span class="pre">manager.count_occupancies()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.deep_copy"><code class="docutils literal notranslate"><span class="pre">manager.deep_copy()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.inflate"><code class="docutils literal notranslate"><span class="pre">manager.inflate()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.is_bool"><code class="docutils literal notranslate"><span class="pre">manager.is_bool()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.is_size_t"><code class="docutils literal notranslate"><span class="pre">manager.is_size_t()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.select"><code class="docutils literal notranslate"><span class="pre">manager.select()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.select_detached"><code class="docutils literal notranslate"><span class="pre">manager.select_detached()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.show"><code class="docutils literal notranslate"><span class="pre">manager.show()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.refinement_flags.manager.szs"><code class="docutils literal notranslate"><span class="pre">manager.szs()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-rigid-body-module">mmtbx.refinement.rigid_body module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.apply_transformation"><code class="docutils literal notranslate"><span class="pre">apply_transformation()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.apply_transformation_"><code class="docutils literal notranslate"><span class="pre">apply_transformation_()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.manager"><code class="docutils literal notranslate"><span class="pre">manager</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.manager.evaluate_after_end"><code class="docutils literal notranslate"><span class="pre">manager.evaluate_after_end()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.manager.rotation"><code class="docutils literal notranslate"><span class="pre">manager.rotation()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.manager.show"><code class="docutils literal notranslate"><span class="pre">manager.show()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.manager.translation"><code class="docutils literal notranslate"><span class="pre">manager.translation()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer"><code class="docutils literal notranslate"><span class="pre">rigid_body_minimizer</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer.compute_functional_and_gradients"><code class="docutils literal notranslate"><span class="pre">rigid_body_minimizer.compute_functional_and_gradients()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer.pack"><code class="docutils literal notranslate"><span class="pre">rigid_body_minimizer.pack()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer.unpack_x"><code class="docutils literal notranslate"><span class="pre">rigid_body_minimizer.unpack_x()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.rigid_body_shift_accumulator"><code class="docutils literal notranslate"><span class="pre">rigid_body_shift_accumulator</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.add"><code class="docutils literal notranslate"><span class="pre">rigid_body_shift_accumulator.add()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.show"><code class="docutils literal notranslate"><span class="pre">rigid_body_shift_accumulator.show()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.rigid_groups_from_pdb_chains"><code class="docutils literal notranslate"><span class="pre">rigid_groups_from_pdb_chains()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.split_resolution_range"><code class="docutils literal notranslate"><span class="pre">split_resolution_range()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.target_and_grads"><code class="docutils literal notranslate"><span class="pre">target_and_grads</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_r"><code class="docutils literal notranslate"><span class="pre">target_and_grads.gradients_wrt_r()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_t"><code class="docutils literal notranslate"><span class="pre">target_and_grads.gradients_wrt_t()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.rigid_body.target_and_grads.target"><code class="docutils literal notranslate"><span class="pre">target_and_grads.target()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-select-best-starting-model-module">mmtbx.refinement.select_best_starting_model module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.evaluate_model"><code class="docutils literal notranslate"><span class="pre">evaluate_model</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_free"><code class="docutils literal notranslate"><span class="pre">evaluate_model.r_free</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_free_start"><code class="docutils literal notranslate"><span class="pre">evaluate_model.r_free_start</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_work"><code class="docutils literal notranslate"><span class="pre">evaluate_model.r_work</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_work_start"><code class="docutils literal notranslate"><span class="pre">evaluate_model.r_work_start</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.show"><code class="docutils literal notranslate"><span class="pre">evaluate_model.show()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.xray_structure"><code class="docutils literal notranslate"><span class="pre">evaluate_model.xray_structure</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model"><code class="docutils literal notranslate"><span class="pre">select_model</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model.evaluate_model"><code class="docutils literal notranslate"><span class="pre">select_model.evaluate_model()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model.get_best_model"><code class="docutils literal notranslate"><span class="pre">select_model.get_best_model()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model.r_free"><code class="docutils literal notranslate"><span class="pre">select_model.r_free()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model.r_work"><code class="docutils literal notranslate"><span class="pre">select_model.r_work()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model.save_best_model"><code class="docutils literal notranslate"><span class="pre">select_model.save_best_model()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model.save_updated_data"><code class="docutils literal notranslate"><span class="pre">select_model.save_updated_data()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model.show"><code class="docutils literal notranslate"><span class="pre">select_model.show()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model.space_group_info"><code class="docutils literal notranslate"><span class="pre">select_model.space_group_info()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.select_model.success"><code class="docutils literal notranslate"><span class="pre">select_model.success()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.strip_model"><code class="docutils literal notranslate"><span class="pre">strip_model()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.select_best_starting_model.ucf"><code class="docutils literal notranslate"><span class="pre">ucf()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-tardy-module">mmtbx.refinement.tardy module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.tardy.action"><code class="docutils literal notranslate"><span class="pre">action()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.tardy.potential_object"><code class="docutils literal notranslate"><span class="pre">potential_object</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.tardy.potential_object.crystal_symmetry"><code class="docutils literal notranslate"><span class="pre">potential_object.crystal_symmetry()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.tardy.potential_object.d_e_pot_d_sites"><code class="docutils literal notranslate"><span class="pre">potential_object.d_e_pot_d_sites()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.tardy.potential_object.e_pot"><code class="docutils literal notranslate"><span class="pre">potential_object.e_pot()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.tardy.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-targets-module">mmtbx.refinement.targets module</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.targets.ls_ff_weights"><code class="docutils literal notranslate"><span class="pre">ls_ff_weights()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.ls_sigma_weights"><code class="docutils literal notranslate"><span class="pre">ls_sigma_weights()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.phaser_sad_target_functor"><code class="docutils literal notranslate"><span class="pre">phaser_sad_target_functor</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.targets.phaser_sad_target_functor.prepare_for_minimization"><code class="docutils literal notranslate"><span class="pre">phaser_sad_target_functor.prepare_for_minimization()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.phaser_sad_target_functor.target_memory"><code class="docutils literal notranslate"><span class="pre">phaser_sad_target_functor.target_memory()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_attributes"><code class="docutils literal notranslate"><span class="pre">target_attributes</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_attributes.requires_experimental_phases"><code class="docutils literal notranslate"><span class="pre">target_attributes.requires_experimental_phases()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_attributes.validate"><code class="docutils literal notranslate"><span class="pre">target_attributes.validate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_functor"><code class="docutils literal notranslate"><span class="pre">target_functor</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_functor.prepare_for_minimization"><code class="docutils literal notranslate"><span class="pre">target_functor.prepare_for_minimization()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_functor.target_function_is_invariant_under_allowed_origin_shifts"><code class="docutils literal notranslate"><span class="pre">target_functor.target_function_is_invariant_under_allowed_origin_shifts()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_result"><code class="docutils literal notranslate"><span class="pre">target_result</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_result.d_target_d_f_calc_work"><code class="docutils literal notranslate"><span class="pre">target_result.d_target_d_f_calc_work()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_result.d_target_d_f_model_work"><code class="docutils literal notranslate"><span class="pre">target_result.d_target_d_f_model_work()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_result.target_per_reflection"><code class="docutils literal notranslate"><span class="pre">target_result.target_per_reflection()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_result.target_test"><code class="docutils literal notranslate"><span class="pre">target_result.target_test()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_result.target_work"><code class="docutils literal notranslate"><span class="pre">target_result.target_work()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_result_mixin"><code class="docutils literal notranslate"><span class="pre">target_result_mixin</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_result_mixin.d_target_d_site_cart"><code class="docutils literal notranslate"><span class="pre">target_result_mixin.d_target_d_site_cart()</span></code></a></li>
<li><a class="reference internal" href="#mmtbx.refinement.targets.target_result_mixin.gradients_wrt_atomic_parameters"><code class="docutils literal notranslate"><span class="pre">target_result_mixin.gradients_wrt_atomic_parameters()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mmtbx-refinement-weights-params-module">mmtbx.refinement.weights_params module</a></li>
<li><a class="reference internal" href="#mmtbx-refinement-wx-tardy-pdb-module">mmtbx.refinement.wx_tardy_pdb module</a></li>
<li><a class="reference internal" href="#module-contents">Module contents</a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.monitors"><code class="docutils literal notranslate"><span class="pre">monitors</span></code></a><ul>
<li><a class="reference internal" href="#mmtbx.refinement.monitors.collect"><code class="docutils literal notranslate"><span class="pre">monitors.collect()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Previous topic</h4>
    <p class="topless"><a href="mmtbx.real_space.html"
                          title="previous chapter">mmtbx.real_space package</a></p>
  </div>
  <div>
    <h4>Next topic</h4>
    <p class="topless"><a href="mmtbx.refinement.ensemble_refinement.html"
                          title="next chapter">mmtbx.refinement.ensemble_refinement package</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/mmtbx/mmtbx.refinement.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mmtbx.refinement.ensemble_refinement.html" title="mmtbx.refinement.ensemble_refinement package"
             >next</a> |</li>
        <li class="right" >
          <a href="mmtbx.real_space.html" title="mmtbx.real_space package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CCTBX Developer documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="mmtbx.html" >mmtbx - macromolecular crystallography</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">mmtbx.refinement package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2014, University of California.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.2.
    </div>
  </body>
</html>