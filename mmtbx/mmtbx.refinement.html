
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>mmtbx.refinement package &#8212; CCTBX Developer documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mmtbx.refinement.ensemble_refinement package" href="mmtbx.refinement.ensemble_refinement.html" />
    <link rel="prev" title="mmtbx.real_space package" href="mmtbx.real_space.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mmtbx.refinement.ensemble_refinement.html" title="mmtbx.refinement.ensemble_refinement package"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mmtbx.real_space.html" title="mmtbx.real_space package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CCTBX Developer documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="mmtbx.html" accesskey="U">mmtbx - macromolecular crystallography</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">mmtbx.refinement package</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mmtbx-refinement-package">
<h1>mmtbx.refinement package<a class="headerlink" href="#mmtbx-refinement-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html">mmtbx.refinement.ensemble_refinement package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#module-mmtbx.refinement.ensemble_refinement.ensemble_utils">mmtbx.refinement.ensemble_refinement.ensemble_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.ensemble_refinement.html#module-mmtbx.refinement.ensemble_refinement">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mmtbx.refinement.real_space.html">mmtbx.refinement.real_space package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#module-mmtbx.refinement.real_space.fit_residue">mmtbx.refinement.real_space.fit_residue module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#module-mmtbx.refinement.real_space.fit_residues">mmtbx.refinement.real_space.fit_residues module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#module-mmtbx.refinement.real_space.fit_water">mmtbx.refinement.real_space.fit_water module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#module-mmtbx.refinement.real_space.individual_sites">mmtbx.refinement.real_space.individual_sites module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#module-mmtbx.refinement.real_space.rigid_body">mmtbx.refinement.real_space.rigid_body module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#module-mmtbx.refinement.real_space.weight">mmtbx.refinement.real_space.weight module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mmtbx.refinement.real_space.html#module-mmtbx.refinement.real_space">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mmtbx.refinement.adp_refinement">
<span id="mmtbx-refinement-adp-refinement-module"></span><h2>mmtbx.refinement.adp_refinement module<a class="headerlink" href="#module-mmtbx.refinement.adp_refinement" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mmtbx.refinement.adp_refinement.manager">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.adp_refinement.</code><code class="sig-name descname">manager</code><span class="sig-paren">(</span><em class="sig-param">fmodels</em>, <em class="sig-param">model</em>, <em class="sig-param">all_params</em>, <em class="sig-param">group_adp_selections=None</em>, <em class="sig-param">group_adp_selections_h=None</em>, <em class="sig-param">group_adp_params=None</em>, <em class="sig-param">tls_selections=None</em>, <em class="sig-param">tls_params=&lt;libtbx.phil.scope_extract object&gt;</em>, <em class="sig-param">individual_adp_params=&lt;libtbx.phil.scope_extract object&gt;</em>, <em class="sig-param">adp_restraints_params=&lt;libtbx.phil.scope_extract object&gt;</em>, <em class="sig-param">refine_adp_individual=None</em>, <em class="sig-param">refine_adp_group=None</em>, <em class="sig-param">refine_tls=None</em>, <em class="sig-param">tan_b_iso_max=None</em>, <em class="sig-param">restraints_manager=None</em>, <em class="sig-param">target_weights=None</em>, <em class="sig-param">macro_cycle=None</em>, <em class="sig-param">log=None</em>, <em class="sig-param">h_params=None</em>, <em class="sig-param">nproc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.adp_refinement.refine_adp">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.adp_refinement.</code><code class="sig-name descname">refine_adp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">fmodels</span></em>, <em class="sig-param"><span class="n">target_weights</span></em>, <em class="sig-param"><span class="n">individual_adp_params</span></em>, <em class="sig-param"><span class="n">adp_restraints_params</span></em>, <em class="sig-param"><span class="n">h_params</span></em>, <em class="sig-param"><span class="n">log</span></em>, <em class="sig-param"><span class="n">all_params</span></em>, <em class="sig-param"><span class="n">nproc</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.adp_refinement.refine_adp.minimize">
<code class="sig-name descname">minimize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.minimize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.adp_refinement.refine_adp.run_lbfgs">
<code class="sig-name descname">run_lbfgs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.run_lbfgs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.adp_refinement.refine_adp.score">
<code class="sig-name descname">score</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rw</span></em>, <em class="sig-param"><span class="n">rf</span></em>, <em class="sig-param"><span class="n">rfrw</span></em>, <em class="sig-param"><span class="n">deltab</span></em>, <em class="sig-param"><span class="n">w</span></em>, <em class="sig-param"><span class="n">score_target</span></em>, <em class="sig-param"><span class="n">score_target_value</span></em>, <em class="sig-param"><span class="n">secondary_target</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.score" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.adp_refinement.refine_adp.select">
<code class="sig-name descname">select</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rw</span></em>, <em class="sig-param"><span class="n">rf</span></em>, <em class="sig-param"><span class="n">rfrw</span></em>, <em class="sig-param"><span class="n">deltab</span></em>, <em class="sig-param"><span class="n">w</span></em>, <em class="sig-param"><span class="n">sel</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.select" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.adp_refinement.refine_adp.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weight</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">show_neutron</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">print_stats</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.adp_refinement.refine_adp.try_weight">
<code class="sig-name descname">try_weight</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weight</span></em>, <em class="sig-param"><span class="n">print_stats</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.refine_adp.try_weight" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.adp_refinement.show_times">
<code class="sig-prename descclassname">mmtbx.refinement.adp_refinement.</code><code class="sig-name descname">show_times</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.show_times" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.adp_refinement.weight_result">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.adp_refinement.</code><code class="sig-name descname">weight_result</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r_work</span></em>, <em class="sig-param"><span class="n">r_free</span></em>, <em class="sig-param"><span class="n">delta_b</span></em>, <em class="sig-param"><span class="n">mean_b</span></em>, <em class="sig-param"><span class="n">weight</span></em>, <em class="sig-param"><span class="n">xray_target</span></em>, <em class="sig-param"><span class="n">neutron_r_work</span></em>, <em class="sig-param"><span class="n">neutron_r_free</span></em>, <em class="sig-param"><span class="n">u_star</span></em>, <em class="sig-param"><span class="n">u_iso</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.weight_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.adp_refinement.weight_result.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.adp_refinement.weight_result.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.anomalous_scatterer_groups">
<span id="mmtbx-refinement-anomalous-scatterer-groups-module"></span><h2>mmtbx.refinement.anomalous_scatterer_groups module<a class="headerlink" href="#module-mmtbx.refinement.anomalous_scatterer_groups" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.anomalous_scatterer_groups.find_anomalous_scatterer_groups">
<code class="sig-prename descclassname">mmtbx.refinement.anomalous_scatterer_groups.</code><code class="sig-name descname">find_anomalous_scatterer_groups</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pdb_atoms</span></em>, <em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">group_same_element</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.find_anomalous_scatterer_groups" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatic setup of anomalously scattering atoms, defined here as anything
with atomic number 15 (P) or greater.  Not yet accessible from phenix.refine.</p>
</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.anomalous_scatterer_groups.get_single_atom_selection_string">
<code class="sig-prename descclassname">mmtbx.refinement.anomalous_scatterer_groups.</code><code class="sig-name descname">get_single_atom_selection_string</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.get_single_atom_selection_string" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.anomalous_scatterer_groups.minimizer">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.anomalous_scatterer_groups.</code><code class="sig-name descname">minimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">groups</span></em>, <em class="sig-param"><span class="n">call_back_after_minimizer_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">number_of_minimizer_cycles</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">lbfgs_max_iterations</span><span class="o">=</span><span class="default_value">20</span></em>, <em class="sig-param"><span class="n">number_of_finite_difference_tests</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.anomalous_scatterer_groups.minimizer.compute_functional_and_gradients">
<code class="sig-name descname">compute_functional_and_gradients</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.minimizer.compute_functional_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.anomalous_scatterer_groups.minimizer.unpack">
<code class="sig-name descname">unpack</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.minimizer.unpack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.anomalous_scatterer_groups.refine_anomalous_substructure">
<code class="sig-prename descclassname">mmtbx.refinement.anomalous_scatterer_groups.</code><code class="sig-name descname">refine_anomalous_substructure</code><span class="sig-paren">(</span><em class="sig-param">fmodel</em>, <em class="sig-param">pdb_hierarchy</em>, <em class="sig-param">wavelength=None</em>, <em class="sig-param">map_type='anom_residual'</em>, <em class="sig-param">exclude_waters=False</em>, <em class="sig-param">exclude_non_water_light_elements=True</em>, <em class="sig-param">n_cycles_max=None</em>, <em class="sig-param">map_sigma_min=3.0</em>, <em class="sig-param">refine=('f_prime'</em>, <em class="sig-param">'f_double_prime')</em>, <em class="sig-param">reset_water_u_iso=True</em>, <em class="sig-param">use_all_anomalous=True</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">out=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='utf-8'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.anomalous_scatterer_groups.refine_anomalous_substructure" title="Permalink to this definition">¶</a></dt>
<dd><p>Crude mimic of Phaser’s substructure completion, with two essential
differences: only the existing real scatterers in the input model will be
used (with the assumption that the model is already more or less complete),
and the anomalous refinement will be performed in Phenix, yielding both
f-prime and f-double-prime.  The refined f-prime provides us with an
orthogonal estimate of the number of electrons missing from an incorrectly
labeled scatterer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wavelength</strong> – X-ray wavelenth in Angstroms</p></li>
<li><p><strong>exclude_waters</strong> – Don’t refine anomalous scattering for water oxygens</p></li>
<li><p><strong>exclude_non_water_light_elements</strong> – Don’t refine anomalous scattering
for light atoms other than water (CHNO).</p></li>
<li><p><strong>n_cycles_max</strong> – Maximum number of refinement cycles</p></li>
<li><p><strong>map_sigma_min</strong> – Sigma cutoff for identify anomalous scatterers</p></li>
<li><p><strong>reset_water_u_iso</strong> – Reset B-factors for water atoms prior to f’
refinement</p></li>
<li><p><strong>use_all_anomalous</strong> – include any scatterers which are already modeled
as anomalous in the refinement</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="mmtbx-refinement-fit-rotamers-module">
<h2>mmtbx.refinement.fit_rotamers module<a class="headerlink" href="#mmtbx-refinement-fit-rotamers-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="mmtbx-refinement-flip-peptides-module">
<h2>mmtbx.refinement.flip_peptides module<a class="headerlink" href="#mmtbx-refinement-flip-peptides-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mmtbx.refinement.geometry_minimization">
<span id="mmtbx-refinement-geometry-minimization-module"></span><h2>mmtbx.refinement.geometry_minimization module<a class="headerlink" href="#module-mmtbx.refinement.geometry_minimization" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.geometry_minimization.add_rotamer_restraints">
<code class="sig-prename descclassname">mmtbx.refinement.geometry_minimization.</code><code class="sig-name descname">add_rotamer_restraints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pdb_hierarchy</span></em>, <em class="sig-param"><span class="n">restraints_manager</span></em>, <em class="sig-param"><span class="n">selection</span></em>, <em class="sig-param"><span class="n">sigma</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">accept_allowed</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">mon_lib_srv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rotamer_manager</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.add_rotamer_restraints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.geometry_minimization.lbfgs">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.geometry_minimization.</code><code class="sig-name descname">lbfgs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sites_cart</span></em>, <em class="sig-param"><span class="n">geometry_restraints_manager</span></em>, <em class="sig-param"><span class="n">geometry_restraints_flags</span></em>, <em class="sig-param"><span class="n">lbfgs_termination_params</span></em>, <em class="sig-param"><span class="n">correct_special_position_tolerance</span></em>, <em class="sig-param"><span class="n">riding_h_manager</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sites_cart_selection</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lbfgs_exception_handling_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rmsd_bonds_termination_cutoff</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">rmsd_angles_termination_cutoff</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">states_collector</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">site_labels</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.lbfgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../cctbx/cctbx.geometry_restraints.lbfgs.html#cctbx.geometry_restraints.lbfgs.lbfgs" title="cctbx.geometry_restraints.lbfgs.lbfgs"><code class="xref py py-class docutils literal notranslate"><span class="pre">cctbx.geometry_restraints.lbfgs.lbfgs</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.geometry_minimization.lbfgs.callback_after_step">
<code class="sig-name descname">callback_after_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">minimizer</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.lbfgs.callback_after_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.geometry_minimization.minimize_wrapper_for_ramachandran">
<code class="sig-prename descclassname">mmtbx.refinement.geometry_minimization.</code><code class="sig-name descname">minimize_wrapper_for_ramachandran</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">original_pdb_h</span></em>, <em class="sig-param"><span class="n">excl_string_selection</span></em>, <em class="sig-param"><span class="n">processed_pdb_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">reference_rotamers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">number_of_cycles</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">run_first_minimization_without_reference</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">oldfield_weight_scale</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">oldfield_plot_cutoff</span><span class="o">=</span><span class="default_value">0.03</span></em>, <em class="sig-param"><span class="n">nonbonded_weight</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">reference_sigma</span><span class="o">=</span><span class="default_value">0.7</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.minimize_wrapper_for_ramachandran" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper around geometry minimization specifically tuned for eliminating
Ramachandran outliers.
probably not working anymore… no processed_pdb_file available.
WARNING: no setting sites_cart at the end…</p>
</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.geometry_minimization.run2">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.geometry_minimization.</code><code class="sig-name descname">run2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">restraints_manager</span></em>, <em class="sig-param"><span class="n">pdb_hierarchy</span></em>, <em class="sig-param"><span class="n">correct_special_position_tolerance</span></em>, <em class="sig-param"><span class="n">riding_h_manager</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ncs_restraints_group_list</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">max_number_of_iterations</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">number_of_macro_cycles</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">selection</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bond</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">nonbonded</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">angle</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">dihedral</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">chirality</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">planarity</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">parallelity</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">rmsd_bonds_termination_cutoff</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">rmsd_angles_termination_cutoff</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">alternate_nonbonded_off_on</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cdl</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">rdl</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">correct_hydrogens</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">fix_rotamer_outliers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">allow_allowed_rotamers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">states_collector</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mon_lib_srv</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ias_selection</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.run2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.geometry_minimization.run2.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.run2.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.geometry_minimization.run2.update_cdl_restraints">
<code class="sig-name descname">update_cdl_restraints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">macro_cycle</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.run2.update_cdl_restraints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.geometry_minimization.run2.updaterdl">
<code class="sig-name descname">updaterdl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">prefix</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.geometry_minimization.run2.updaterdl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.group">
<span id="mmtbx-refinement-group-module"></span><h2>mmtbx.refinement.group module<a class="headerlink" href="#module-mmtbx.refinement.group" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.group.apply_transformation">
<code class="sig-prename descclassname">mmtbx.refinement.group.</code><code class="sig-name descname">apply_transformation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">par</span></em>, <em class="sig-param"><span class="n">selections</span></em>, <em class="sig-param"><span class="n">sc_start</span></em>, <em class="sig-param"><span class="n">refine_adp</span></em>, <em class="sig-param"><span class="n">refine_occ</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.apply_transformation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.group.group_minimizer">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.group.</code><code class="sig-name descname">group_minimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">sc_start</span></em>, <em class="sig-param"><span class="n">selections</span></em>, <em class="sig-param"><span class="n">par_initial</span></em>, <em class="sig-param"><span class="n">refine_adp</span></em>, <em class="sig-param"><span class="n">refine_occ</span></em>, <em class="sig-param"><span class="n">max_number_of_iterations</span></em>, <em class="sig-param"><span class="n">run_finite_differences_test</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">restraints_weight</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">restraints_manager</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.group.group_minimizer.apply_shifts">
<code class="sig-name descname">apply_shifts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.apply_shifts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.group.group_minimizer.compute_functional_and_gradients">
<code class="sig-name descname">compute_functional_and_gradients</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.compute_functional_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.group.group_minimizer.finite_difference_test">
<code class="sig-name descname">finite_difference_test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.finite_difference_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.group.group_minimizer.get_restraints_tg">
<code class="sig-name descname">get_restraints_tg</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.get_restraints_tg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.group.group_minimizer.get_tg">
<code class="sig-name descname">get_tg</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compute_gradients</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.get_tg" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.group.group_minimizer.pack">
<code class="sig-name descname">pack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.group.group_minimizer.unpack_x">
<code class="sig-name descname">unpack_x</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.group_minimizer.unpack_x" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.group.manager">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.group.</code><code class="sig-name descname">manager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">selections</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_number_of_iterations</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">number_of_macro_cycles</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">use_restraints</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">restraints_weight</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">convergence_test</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">convergence_delta</span><span class="o">=</span><span class="default_value">1e-05</span></em>, <em class="sig-param"><span class="n">run_finite_differences_test</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_adp</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_occ</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">occupancy_max</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">occupancy_min</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.group.manager.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rw</span></em>, <em class="sig-param"><span class="n">rf</span></em>, <em class="sig-param"><span class="n">tw</span></em>, <em class="sig-param"><span class="n">mc</span></em>, <em class="sig-param"><span class="n">it</span></em>, <em class="sig-param"><span class="n">refine_adp</span></em>, <em class="sig-param"><span class="n">refine_occ</span></em>, <em class="sig-param"><span class="n">weight</span></em>, <em class="sig-param"><span class="n">out</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.manager.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.group.show_times">
<code class="sig-prename descclassname">mmtbx.refinement.group.</code><code class="sig-name descname">show_times</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.show_times" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.group.sphere_similarity_restraints">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.group.</code><code class="sig-name descname">sphere_similarity_restraints</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">selection</span></em>, <em class="sig-param"><span class="n">refine_adp</span></em>, <em class="sig-param"><span class="n">refine_occ</span></em>, <em class="sig-param"><span class="n">sphere_radius</span><span class="o">=</span><span class="default_value">5.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.sphere_similarity_restraints" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.group.sphere_similarity_restraints.target_and_gradients">
<code class="sig-name descname">target_and_gradients</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">to_compute_weight</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.sphere_similarity_restraints.target_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.group.target_and_grads">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.group.</code><code class="sig-name descname">target_and_grads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target_functor</span></em>, <em class="sig-param"><span class="n">selections</span></em>, <em class="sig-param"><span class="n">refine_adp</span></em>, <em class="sig-param"><span class="n">refine_occ</span></em>, <em class="sig-param"><span class="n">compute_gradients</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">rtg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">weight</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.target_and_grads" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.group.target_and_grads.gradients_wrt_par">
<code class="sig-name descname">gradients_wrt_par</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.target_and_grads.gradients_wrt_par" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.group.target_and_grads.target">
<code class="sig-name descname">target</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.group.target_and_grads.target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.inspect_tardy_trajectory">
<span id="mmtbx-refinement-inspect-tardy-trajectory-module"></span><h2>mmtbx.refinement.inspect_tardy_trajectory module<a class="headerlink" href="#module-mmtbx.refinement.inspect_tardy_trajectory" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.inspect_tardy_trajectory.run">
<code class="sig-prename descclassname">mmtbx.refinement.inspect_tardy_trajectory.</code><code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.inspect_tardy_trajectory.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.minimization">
<span id="mmtbx-refinement-minimization-module"></span><h2>mmtbx.refinement.minimization module<a class="headerlink" href="#module-mmtbx.refinement.minimization" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mmtbx.refinement.minimization.lbfgs">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.minimization.</code><code class="sig-name descname">lbfgs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodels</span></em>, <em class="sig-param"><span class="n">restraints_manager</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">is_neutron_scat_table</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">target_weights</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">refine_xyz</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_adp</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">lbfgs_termination_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_fortran</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">correct_special_position_tolerance</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">iso_restraints</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">h_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">qblib_params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">macro_cycle</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">u_min</span><span class="o">=</span><span class="default_value">- 0.06332573977646111</span></em>, <em class="sig-param"><span class="n">u_max</span><span class="o">=</span><span class="default_value">12.665021303812669</span></em>, <em class="sig-param"><span class="n">collect_monitor</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.minimization.lbfgs.apply_shifts">
<code class="sig-name descname">apply_shifts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs.apply_shifts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization.lbfgs.callback_after_step">
<code class="sig-name descname">callback_after_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">minimizer</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs.callback_after_step" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization.lbfgs.compute_functional_and_gradients">
<code class="sig-name descname">compute_functional_and_gradients</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs.compute_functional_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization.lbfgs.compute_target">
<code class="sig-name descname">compute_target</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compute_gradients</span></em>, <em class="sig-param"><span class="n">u_iso_refinable_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.lbfgs.compute_target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.minimization.monitor">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.minimization.</code><code class="sig-name descname">monitor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">weights</span></em>, <em class="sig-param"><span class="n">fmodels</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">iso_restraints</span></em>, <em class="sig-param"><span class="n">refine_xyz</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_adp</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_occ</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.minimization.monitor.collect">
<code class="sig-name descname">collect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iter</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">nfun</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor.collect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization.monitor.neutron_line">
<code class="sig-name descname">neutron_line</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_seq</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor.neutron_line" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization.monitor.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">message</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization.monitor.xray_line">
<code class="sig-name descname">xray_line</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">i_seq</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.monitor.xray_line" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.minimization.run_constrained">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.minimization.</code><code class="sig-name descname">run_constrained</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">target_weight</span></em>, <em class="sig-param"><span class="n">log</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">prefix</span></em>, <em class="sig-param"><span class="n">refine_sites</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_u_iso</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_transformations</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization.run_constrained" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.minimization_ncs_constraints">
<span id="mmtbx-refinement-minimization-ncs-constraints-module"></span><h2>mmtbx.refinement.minimization_ncs_constraints module<a class="headerlink" href="#module-mmtbx.refinement.minimization_ncs_constraints" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.minimization_ncs_constraints.grads_asu_to_one_ncs">
<code class="sig-prename descclassname">mmtbx.refinement.minimization_ncs_constraints.</code><code class="sig-name descname">grads_asu_to_one_ncs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ncs_restraints_group_list</span></em>, <em class="sig-param"><span class="n">extended_ncs_selection</span></em>, <em class="sig-param"><span class="n">grad</span></em>, <em class="sig-param"><span class="n">refine_sites</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.grads_asu_to_one_ncs" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply NCS constraints to reduce the gradients corresponding to whole ASU, to
gradients corresponding to one NCS copy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncs_restraints_group_list</strong> – list of ncs_restraint_group objects</p></li>
<li><p><strong>grad</strong> – gradient of the complete asu</p></li>
<li><p><strong>refine_sites</strong> – (bool) Flag indicating sites refinement</p></li>
<li><p><strong>extended_ncs_selection</strong> (<em>flex.siz_t</em>) – selection of all ncs groups master ncs
selection and non ncs related portions that are being refined (exclude
NCS copies)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.minimization_ncs_constraints.grads_one_ncs_to_asu">
<code class="sig-prename descclassname">mmtbx.refinement.minimization_ncs_constraints.</code><code class="sig-name descname">grads_one_ncs_to_asu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ncs_restraints_group_list</span></em>, <em class="sig-param"><span class="n">total_asu_length</span></em>, <em class="sig-param"><span class="n">extended_ncs_selection</span></em>, <em class="sig-param"><span class="n">master_grad</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.grads_one_ncs_to_asu" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand average gradient of a single NCS to all ASU
(only for u_iso refinement)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncs_restraints_group_list</strong> – list of ncs_restraint_group objects</p></li>
<li><p><strong>total_asu_length</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.int" title="scitbx.array_family.flex.int"><em>int</em></a>) – length of the complete ASU</p></li>
<li><p><strong>extended_ncs_selection</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.size_t" title="scitbx.array_family.flex.size_t"><em>flex.size_t</em></a>) – selection of all ncs groups master ncs
selection and non ncs related portions that are being refined (exclude
NCS copies)</p></li>
<li><p><strong>master_grad</strong> – gradient of a single ncs copy (the master copy)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.minimization_ncs_constraints.lbfgs">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.minimization_ncs_constraints.</code><code class="sig-name descname">lbfgs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ncs_restraints_group_list</span></em>, <em class="sig-param"><span class="n">target_and_grads_object</span></em>, <em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">refine_selection</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">finite_grad_differences_test</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">finite_grad_difference_val</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">max_iterations</span><span class="o">=</span><span class="default_value">35</span></em>, <em class="sig-param"><span class="n">refine_sites</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_u_iso</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_transformations</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.lbfgs.compute_functional_and_gradients">
<code class="sig-name descname">compute_functional_and_gradients</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compute_gradients</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.compute_functional_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.lbfgs.finite_difference_test">
<code class="sig-name descname">finite_difference_test</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">g</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.finite_difference_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare analytical and finite differences gradients.</p>
<p>finite_grad_difference_val = abs(analytical - finite differences)</p>
</dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.lbfgs.refinable_params_one_ncs_to_asu">
<code class="sig-name descname">refinable_params_one_ncs_to_asu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.refinable_params_one_ncs_to_asu" title="Permalink to this definition">¶</a></dt>
<dd><p>Expand refinabale parameters corresponding to one NCS copy to parameters
corresponding to whole ASU.</p>
</dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.lbfgs.update_xray_structure">
<code class="sig-name descname">update_xray_structure</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.lbfgs.update_xray_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Update xray_structure with refined parameters, then update
fmodel object with updated xray_structure.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.minimization_ncs_constraints.restraints_target_and_grads">
<code class="sig-prename descclassname">mmtbx.refinement.minimization_ncs_constraints.</code><code class="sig-name descname">restraints_target_and_grads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ncs_restraints_group_list</span></em>, <em class="sig-param"><span class="n">restraints_manager</span></em>, <em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">grad</span></em>, <em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">refine_sites</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_u_iso</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_transformations</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">iso_restraints</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_hd</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.restraints_target_and_grads" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ncs_restraints_group_list</strong> – NCS operator list</p></li>
<li><p><strong>restraints_manager</strong> – (object)</p></li>
<li><p><strong>xray_structure</strong> – (object)</p></li>
<li><p><strong>grad</strong> – gradient without restraints</p></li>
<li><p><strong>x</strong> – refined parameter</p></li>
<li><p><strong>refine_sites</strong> – (bool) indicate refinement type</p></li>
<li><p><strong>refine_u_iso</strong> – (bool) indicate refinement type</p></li>
<li><p><strong>refine_transformations</strong> – (bool) indicate refinement type</p></li>
<li><p><strong>iso_restraints</strong> – (object) iso restraints parameters</p></li>
<li><p><strong>use_hd</strong> – (bool) Use hydrogen</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>(float) restraints target function value
ef_grad: (flex.double or flex.vec3_double) restraints gradient</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ef_target</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.minimization_ncs_constraints.</code><code class="sig-name descname">target_function_and_grads_geometry_minimization</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">ncs_restraints_group_list</span></em>, <em class="sig-param"><span class="n">refine_selection</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_ncs_constraints</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">restraints_manager</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">refine_sites</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_transformations</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Target and gradients evaluator for geometry minimization (no data)</p>
<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization.target_and_gradients">
<code class="sig-name descname">target_and_gradients</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compute_gradients</span></em>, <em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_geometry_minimization.target_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.minimization_ncs_constraints.</code><code class="sig-name descname">target_function_and_grads_real_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">map_data</span></em>, <em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">ncs_restraints_group_list</span></em>, <em class="sig-param"><span class="n">real_space_gradients_delta</span></em>, <em class="sig-param"><span class="n">refine_selection</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_ncs_constraints</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">restraints_manager</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_weight</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">refine_sites</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Real-space target and gradients evaluator</p>
<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.data_target_and_grads">
<code class="sig-name descname">data_target_and_grads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compute_gradients</span></em>, <em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.data_target_and_grads" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compute_gradients</strong> – (bool) when True compute gradients</p></li>
<li><p><strong>x</strong> – refined parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.target_and_gradients">
<code class="sig-name descname">target_and_gradients</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compute_gradients</span></em>, <em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_real_space.target_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>compute_gradients</strong> – (bool) when True compute gradients</p></li>
<li><p><strong>xray_structure</strong> – xray_structure object</p></li>
<li><p><strong>x</strong> – refined parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.minimization_ncs_constraints.</code><code class="sig-name descname">target_function_and_grads_reciprocal_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">ncs_restraints_group_list</span></em>, <em class="sig-param"><span class="n">refine_selection</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_ncs_constraints</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">restraints_manager</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data_weight</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">refine_sites</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_u_iso</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refine_transformations</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">iso_restraints</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_hd</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Reciprocal-space target and gradients evaluator</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>refine_selection</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.size_t" title="scitbx.array_family.flex.size_t"><em>flex.size_t</em></a>) – of all ncs related copies and
non ncs related parts to be refined</p>
</dd>
</dl>
<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.data_target_and_grads">
<code class="sig-name descname">data_target_and_grads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compute_gradients</span></em>, <em class="sig-param"><span class="n">sites_cart</span></em>, <em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.data_target_and_grads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.finalize">
<code class="sig-name descname">finalize</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.finalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.target_and_gradients">
<code class="sig-name descname">target_and_gradients</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">compute_gradients</span></em>, <em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.minimization_ncs_constraints.target_function_and_grads_reciprocal_space.target_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.occupancies">
<span id="mmtbx-refinement-occupancies-module"></span><h2>mmtbx.refinement.occupancies module<a class="headerlink" href="#module-mmtbx.refinement.occupancies" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.occupancies.add_occupancy_selection">
<code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">add_occupancy_selection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">result</span></em>, <em class="sig-param"><span class="n">size</span></em>, <em class="sig-param"><span class="n">selection</span></em>, <em class="sig-param"><span class="n">hd_special</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.add_occupancy_selection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.occupancies.assemble_constraint_groups_3d">
<code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">assemble_constraint_groups_3d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">pdb_atoms</span></em>, <em class="sig-param"><span class="n">constraint_groups</span></em>, <em class="sig-param"><span class="n">interaction_distance_cutoff</span><span class="o">=</span><span class="default_value">4.0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.assemble_constraint_groups_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-sorts occupancy constraint groups so that conformers whose motion is
correlated (i.e. they interact in 3D, without necessarily being part of
the same fragment/molecule/ASU) are grouped together.  As input, it expects
the constraint groups output by mmtbx.utils.occupancy_selections(), which
will already have connectivity taken into account.  This function will exit
with an error if the occupancies for the new groups are not consistent.</p>
</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.occupancies.extract_partial_occupancy_selections">
<code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">extract_partial_occupancy_selections</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hierarchy</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.extract_partial_occupancy_selections" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.occupancies.list_3d_as_bool_selection">
<code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">list_3d_as_bool_selection</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">list_3d</span></em>, <em class="sig-param"><span class="n">size</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.list_3d_as_bool_selection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.occupancies.manager">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">manager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodels</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">max_number_of_iterations</span><span class="o">=</span><span class="default_value">25</span></em>, <em class="sig-param"><span class="n">number_of_macro_cycles</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">occupancy_max</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">occupancy_min</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exclude_hd</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.occupancies.manager.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodels</span></em>, <em class="sig-param"><span class="n">message</span></em>, <em class="sig-param"><span class="n">log</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.manager.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.occupancies.manager.show_helper">
<code class="sig-name descname">show_helper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">log</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.manager.show_helper" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.occupancies.minimizer">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">minimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodels</span></em>, <em class="sig-param"><span class="n">constrained_groups_selections</span></em>, <em class="sig-param"><span class="n">selections</span></em>, <em class="sig-param"><span class="n">par_initial</span></em>, <em class="sig-param"><span class="n">max_number_of_iterations</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.occupancies.minimizer.compute_functional_and_gradients">
<code class="sig-name descname">compute_functional_and_gradients</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.minimizer.compute_functional_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.occupancies.minimizer.pack">
<code class="sig-name descname">pack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">par</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.minimizer.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.occupancies.minimizer.unpack_x">
<code class="sig-name descname">unpack_x</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.minimizer.unpack_x" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.occupancies.occupancy_regroupping">
<code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">occupancy_regroupping</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pdb_hierarchy</span></em>, <em class="sig-param"><span class="n">cgs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.occupancy_regroupping" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.occupancies.occupancy_selections">
<code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">occupancy_selections</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">add_water</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">other_individual_selection_strings</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">other_constrained_groups</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">remove_selection</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">as_flex_arrays</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">constrain_correlated_3d_groups</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.occupancy_selections" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.occupancies.pack_gradients">
<code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">pack_gradients</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">table</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.pack_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.occupancies.pack_unpack">
<code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">pack_unpack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">table</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.pack_unpack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.occupancies.set_refinable_parameters">
<code class="sig-prename descclassname">mmtbx.refinement.occupancies.</code><code class="sig-name descname">set_refinable_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">parameters</span></em>, <em class="sig-param"><span class="n">selections</span></em>, <em class="sig-param"><span class="n">enforce_positivity</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.occupancies.set_refinable_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.orca">
<span id="mmtbx-refinement-orca-module"></span><h2>mmtbx.refinement.orca module<a class="headerlink" href="#module-mmtbx.refinement.orca" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.orca.average_sites_cart">
<code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">average_sites_cart</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">related_x_i_seqs</span></em>, <em class="sig-param"><span class="n">x_sites_cart</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.average_sites_cart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.orca.expand">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">expand</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">sites_cart</span></em>, <em class="sig-param"><span class="n">masses</span></em>, <em class="sig-param"><span class="n">geo_manager</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.orca.expand.rmsd_calculation">
<code class="sig-name descname">rmsd_calculation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sites_cart_1</span></em>, <em class="sig-param"><span class="n">sites_cart_2</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand.rmsd_calculation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.orca.expand.rmsd_calculator">
<code class="sig-name descname">rmsd_calculator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tardy_tree_rmsd_calculator</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand.rmsd_calculator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.orca.expand_angle_proxies">
<code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">expand_angle_proxies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">angle_proxies</span></em>, <em class="sig-param"><span class="n">x_n_seq</span></em>, <em class="sig-param"><span class="n">related_x_i_seqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_angle_proxies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.orca.expand_bond_params_table">
<code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">expand_bond_params_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bond_params_table</span></em>, <em class="sig-param"><span class="n">x_n_seq</span></em>, <em class="sig-param"><span class="n">related_x_i_seqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_bond_params_table" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.orca.expand_dihedral_or_chirality_proxies">
<code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">expand_dihedral_or_chirality_proxies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">proxies</span></em>, <em class="sig-param"><span class="n">proxy_type</span></em>, <em class="sig-param"><span class="n">proxy_array_type</span></em>, <em class="sig-param"><span class="n">x_n_seq</span></em>, <em class="sig-param"><span class="n">related_x_i_seqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_dihedral_or_chirality_proxies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.orca.expand_model_or_conformer_indices">
<code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">expand_model_or_conformer_indices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">indices</span></em>, <em class="sig-param"><span class="n">x_n_seq</span></em>, <em class="sig-param"><span class="n">related_x_i_seqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_model_or_conformer_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.orca.expand_nonbonded_types">
<code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">expand_nonbonded_types</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">nonbonded_types</span></em>, <em class="sig-param"><span class="n">x_n_seq</span></em>, <em class="sig-param"><span class="n">related_x_i_seqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_nonbonded_types" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.orca.expand_pair_sym_table">
<code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">expand_pair_sym_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pair_sym_table</span></em>, <em class="sig-param"><span class="n">x_n_seq</span></em>, <em class="sig-param"><span class="n">related_x_i_seqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_pair_sym_table" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.orca.expand_planarity_proxies">
<code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">expand_planarity_proxies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">planarity_proxies</span></em>, <em class="sig-param"><span class="n">x_n_seq</span></em>, <em class="sig-param"><span class="n">related_x_i_seqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_planarity_proxies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.orca.expand_site_symmetry_table">
<code class="sig-prename descclassname">mmtbx.refinement.orca.</code><code class="sig-name descname">expand_site_symmetry_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">site_symmetry_table</span></em>, <em class="sig-param"><span class="n">x_n_seq</span></em>, <em class="sig-param"><span class="n">related_x_i_seqs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.orca.expand_site_symmetry_table" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.print_statistics">
<span id="mmtbx-refinement-print-statistics-module"></span><h2>mmtbx.refinement.print_statistics module<a class="headerlink" href="#module-mmtbx.refinement.print_statistics" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mmtbx.refinement.print_statistics.annealing_callback">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">annealing_callback</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">monitor</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.annealing_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.print_statistics.coordinate_shifts">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">coordinate_shifts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hierarchy_start</span></em>, <em class="sig-param"><span class="n">hierarchy_end</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.coordinate_shifts" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.print_statistics.coordinate_shifts.get_shifts">
<code class="sig-name descname">get_shifts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.coordinate_shifts.get_shifts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.print_statistics.coordinate_shifts.min_max_mean">
<code class="sig-name descname">min_max_mean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.coordinate_shifts.min_max_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.print_statistics.coordinate_shifts.save_pdb_file">
<code class="sig-name descname">save_pdb_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.coordinate_shifts.save_pdb_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.print_statistics.macro_cycle_header">
<code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">macro_cycle_header</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">macro_cycle</span></em>, <em class="sig-param"><span class="n">number_of_macro_cycles</span></em>, <em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.macro_cycle_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.print_statistics.make_header">
<code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">make_header</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">line</span></em>, <em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.make_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.print_statistics.make_sub_header">
<code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">make_sub_header</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span></em>, <em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.make_sub_header" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.print_statistics.refinement_monitor">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">refinement_monitor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">neutron_refinement</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">call_back_handler</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">is_neutron_monitor</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.print_statistics.refinement_monitor.call_back">
<code class="sig-name descname">call_back</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">method</span><span class="o">=</span><span class="default_value">'monitor_collect'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.call_back" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.print_statistics.refinement_monitor.collect">
<code class="sig-name descname">collect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">step</span></em>, <em class="sig-param"><span class="n">wilson_b</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rigid_body_shift_accumulator</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.collect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.print_statistics.refinement_monitor.dump_statistics">
<code class="sig-name descname">dump_statistics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.dump_statistics" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.print_statistics.refinement_monitor.format_stats_for_phenix_gui">
<code class="sig-name descname">format_stats_for_phenix_gui</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.format_stats_for_phenix_gui" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.print_statistics.refinement_monitor.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">remark</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.print_statistics.refinement_monitor.show_current_r_factors_summary">
<code class="sig-name descname">show_current_r_factors_summary</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.refinement_monitor.show_current_r_factors_summary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.print_statistics.show_process_info">
<code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">show_process_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.show_process_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.print_statistics.show_rigid_body_rotations_and_translations">
<code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">show_rigid_body_rotations_and_translations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out</span></em>, <em class="sig-param"><span class="n">prefix</span></em>, <em class="sig-param"><span class="n">frame</span></em>, <em class="sig-param"><span class="n">euler_angle_convention</span></em>, <em class="sig-param"><span class="n">rotations</span></em>, <em class="sig-param"><span class="n">translations</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.show_rigid_body_rotations_and_translations" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.print_statistics.show_times">
<code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">show_times</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.show_times" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.print_statistics.stats_table">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">stats_table</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwds</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../libtbx/index.html#libtbx.slots_getstate_setstate" title="libtbx.slots_getstate_setstate"><code class="xref py py-class docutils literal notranslate"><span class="pre">libtbx.slots_getstate_setstate</span></code></a></p>
<dl class="py attribute">
<dt id="mmtbx.refinement.print_statistics.stats_table.as_ave">
<code class="sig-name descname">as_ave</code><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.as_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="mmtbx.refinement.print_statistics.stats_table.bs_ave">
<code class="sig-name descname">bs_ave</code><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.bs_ave" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="mmtbx.refinement.print_statistics.stats_table.neutron_flag">
<code class="sig-name descname">neutron_flag</code><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.neutron_flag" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="mmtbx.refinement.print_statistics.stats_table.r_frees">
<code class="sig-name descname">r_frees</code><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.r_frees" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="mmtbx.refinement.print_statistics.stats_table.r_works">
<code class="sig-name descname">r_works</code><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.r_works" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="mmtbx.refinement.print_statistics.stats_table.steps">
<code class="sig-name descname">steps</code><a class="headerlink" href="#mmtbx.refinement.print_statistics.stats_table.steps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.print_statistics.trajectory_output">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.print_statistics.</code><code class="sig-name descname">trajectory_output</code><span class="sig-paren">(</span><em class="sig-param">file_base='refine'</em>, <em class="sig-param">filled_maps=True</em>, <em class="sig-param">log=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='utf-8'&gt;</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.print_statistics.trajectory_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Callback object for saving the intermediate results of refinement as a stack
of PDB and MTZ files.  Equivalent to the interactivity with Coot in the
Phenix GUI, but intended for command-line use and demonstrative purposes.</p>
</dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.refinement_flags">
<span id="mmtbx-refinement-refinement-flags-module"></span><h2>mmtbx.refinement.refinement_flags module<a class="headerlink" href="#module-mmtbx.refinement.refinement_flags" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mmtbx.refinement.refinement_flags.manager">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.refinement_flags.</code><code class="sig-name descname">manager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">individual_sites</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">torsion_angles</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">rigid_body</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">individual_adp</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">group_adp</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tls</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">occupancies</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">group_anomalous</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sites_individual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sites_torsion_angles</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sites_rigid_body</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adp_individual_iso</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adp_individual_aniso</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adp_group</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">group_h</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adp_tls</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">s_occupancies</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">next_to_i_seqs</span></em>, <em class="sig-param"><span class="n">sites_individual</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sites_torsion_angles</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sites_rigid_body</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">adp_individual_iso</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">adp_individual_aniso</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">adp_group</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">group_h</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">adp_tls</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">s_occupancies</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.ca">
<code class="sig-name descname">ca</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.ca" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.check_all">
<code class="sig-name descname">check_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.check_all" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.count_occupancies">
<code class="sig-name descname">count_occupancies</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.count_occupancies" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.deep_copy">
<code class="sig-name descname">deep_copy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.deep_copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.inflate">
<code class="sig-name descname">inflate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sites_individual</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sites_torsion_angles</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sites_rigid_body</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adp_individual_iso</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adp_individual_aniso</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adp_group</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">group_h</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adp_tls</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">s_occupancies</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">occupancies_group</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">size_all</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.inflate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.is_bool">
<code class="sig-name descname">is_bool</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.is_bool" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.is_size_t">
<code class="sig-name descname">is_size_t</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.is_size_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.select">
<code class="sig-name descname">select</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">selection</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.select" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.select_detached">
<code class="sig-name descname">select_detached</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">selection</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.select_detached" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.refinement_flags.manager.szs">
<code class="sig-name descname">szs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.refinement_flags.manager.szs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.rigid_body">
<span id="mmtbx-refinement-rigid-body-module"></span><h2>mmtbx.refinement.rigid_body module<a class="headerlink" href="#module-mmtbx.refinement.rigid_body" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.rigid_body.apply_transformation">
<code class="sig-prename descclassname">mmtbx.refinement.rigid_body.</code><code class="sig-name descname">apply_transformation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">rotation_matrices</span></em>, <em class="sig-param"><span class="n">translation_vectors</span></em>, <em class="sig-param"><span class="n">selections</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.apply_transformation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.rigid_body.apply_transformation_">
<code class="sig-prename descclassname">mmtbx.refinement.rigid_body.</code><code class="sig-name descname">apply_transformation_</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">sites_cart</span></em>, <em class="sig-param"><span class="n">sites_frac</span></em>, <em class="sig-param"><span class="n">rotation_matrices</span></em>, <em class="sig-param"><span class="n">translation_vectors</span></em>, <em class="sig-param"><span class="n">selections</span></em>, <em class="sig-param"><span class="n">atomic_weights</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.apply_transformation_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.rigid_body.manager">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.rigid_body.</code><code class="sig-name descname">manager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">selections</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">r_initial</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">t_initial</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">bss</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">monitors</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.manager.evaluate_after_end">
<code class="sig-name descname">evaluate_after_end</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">save_r_work</span></em>, <em class="sig-param"><span class="n">save_r_free</span></em>, <em class="sig-param"><span class="n">save_xray_structure</span></em>, <em class="sig-param"><span class="n">log</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager.evaluate_after_end" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.manager.rotation">
<code class="sig-name descname">rotation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager.rotation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.manager.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">r_mat</span></em>, <em class="sig-param"><span class="n">t_vec</span></em>, <em class="sig-param"><span class="n">header</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.manager.translation">
<code class="sig-name descname">translation</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.manager.translation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.rigid_body.rigid_body_minimizer">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.rigid_body.</code><code class="sig-name descname">rigid_body_minimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodel</span></em>, <em class="sig-param"><span class="n">selections</span></em>, <em class="sig-param"><span class="n">r_initial</span></em>, <em class="sig-param"><span class="n">t_initial</span></em>, <em class="sig-param"><span class="n">refine_r</span></em>, <em class="sig-param"><span class="n">refine_t</span></em>, <em class="sig-param"><span class="n">max_iterations</span></em>, <em class="sig-param"><span class="n">euler_angle_convention</span></em>, <em class="sig-param"><span class="n">lbfgs_maxfev</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.rigid_body_minimizer.compute_functional_and_gradients">
<code class="sig-name descname">compute_functional_and_gradients</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">suppress_gradients</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer.compute_functional_and_gradients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.rigid_body_minimizer.pack">
<code class="sig-name descname">pack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">r</span></em>, <em class="sig-param"><span class="n">t</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer.pack" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.rigid_body_minimizer.unpack_x">
<code class="sig-name descname">unpack_x</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_minimizer.unpack_x" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.rigid_body.rigid_body_shift_accumulator">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.rigid_body.</code><code class="sig-name descname">rigid_body_shift_accumulator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">euler_angle_convention</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_shift_accumulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rotations</span></em>, <em class="sig-param"><span class="n">translations</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.add" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_body_shift_accumulator.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.rigid_body.rigid_groups_from_pdb_chains">
<code class="sig-prename descclassname">mmtbx.refinement.rigid_body.</code><code class="sig-name descname">rigid_groups_from_pdb_chains</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pdb_hierarchy</span></em>, <em class="sig-param"><span class="n">min_chain_size</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">xray_structure</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">check_for_atoms_on_special_positions</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">group_all_by_chain</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.rigid_groups_from_pdb_chains" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.rigid_body.split_resolution_range">
<code class="sig-prename descclassname">mmtbx.refinement.rigid_body.</code><code class="sig-name descname">split_resolution_range</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d_spacings</span></em>, <em class="sig-param"><span class="n">n_bodies</span></em>, <em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="n">target_auto_switch_resolution</span></em>, <em class="sig-param"><span class="n">n_ref_first</span></em>, <em class="sig-param"><span class="n">multi_body_factor_n_ref_first</span></em>, <em class="sig-param"><span class="n">d_low</span></em>, <em class="sig-param"><span class="n">d_high</span></em>, <em class="sig-param"><span class="n">number_of_zones</span></em>, <em class="sig-param"><span class="n">zone_exponent</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.split_resolution_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.rigid_body.target_and_grads">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.rigid_body.</code><code class="sig-name descname">target_and_grads</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">centers_of_mass</span></em>, <em class="sig-param"><span class="n">sites_cart</span></em>, <em class="sig-param"><span class="n">target_functor</span></em>, <em class="sig-param"><span class="n">rot_objs</span></em>, <em class="sig-param"><span class="n">selections</span></em>, <em class="sig-param"><span class="n">suppress_gradients</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.target_and_grads" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_r">
<code class="sig-name descname">gradients_wrt_r</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_r" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_t">
<code class="sig-name descname">gradients_wrt_t</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.target_and_grads.gradients_wrt_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.rigid_body.target_and_grads.target">
<code class="sig-name descname">target</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.rigid_body.target_and_grads.target" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.select_best_starting_model">
<span id="mmtbx-refinement-select-best-starting-model-module"></span><h2>mmtbx.refinement.select_best_starting_model module<a class="headerlink" href="#module-mmtbx.refinement.select_best_starting_model" title="Permalink to this headline">¶</a></h2>
<p>This module provides a way to identify a suitably isomorphous initial model
for directly refining against experimental data.  This is commonly done when
solving a series of ligand-bound structures, partly to save time, and partly
to avoid changing the frame of reference when running molecular replacement.</p>
<dl class="py class">
<dt id="mmtbx.refinement.select_best_starting_model.evaluate_model">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.select_best_starting_model.</code><code class="sig-name descname">evaluate_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">pdb_hierarchy</span></em>, <em class="sig-param"><span class="n">f_obs</span></em>, <em class="sig-param"><span class="n">r_free_flags</span></em>, <em class="sig-param"><span class="n">rigid_body_refine</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">optimize_b_factors</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">skip_twin_detection</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">scattering_table</span><span class="o">=</span><span class="default_value">'n_gaussian'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../libtbx/index.html#libtbx.slots_getstate_setstate" title="libtbx.slots_getstate_setstate"><code class="xref py py-class docutils literal notranslate"><span class="pre">libtbx.slots_getstate_setstate</span></code></a></p>
<p>Create an fmodel object (including bulk solvent correction) and calculate
R-factors, with or without optional rigid-body refinement.</p>
<dl class="py attribute">
<dt id="mmtbx.refinement.select_best_starting_model.evaluate_model.r_free">
<code class="sig-name descname">r_free</code><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_free" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="mmtbx.refinement.select_best_starting_model.evaluate_model.r_free_start">
<code class="sig-name descname">r_free_start</code><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_free_start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="mmtbx.refinement.select_best_starting_model.evaluate_model.r_work">
<code class="sig-name descname">r_work</code><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_work" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="mmtbx.refinement.select_best_starting_model.evaluate_model.r_work_start">
<code class="sig-name descname">r_work_start</code><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.r_work_start" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.evaluate_model.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param">out=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='utf-8'&gt;</em>, <em class="sig-param">prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="mmtbx.refinement.select_best_starting_model.evaluate_model.xray_structure">
<code class="sig-name descname">xray_structure</code><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.evaluate_model.xray_structure" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.select_best_starting_model.select_model">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.select_best_starting_model.</code><code class="sig-name descname">select_model</code><span class="sig-paren">(</span><em class="sig-param">model_names</em>, <em class="sig-param">model_data</em>, <em class="sig-param">f_obs</em>, <em class="sig-param">r_free_flags</em>, <em class="sig-param">params=None</em>, <em class="sig-param">skip_twin_detection=False</em>, <em class="sig-param">nproc=1</em>, <em class="sig-param">log=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='utf-8'&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.select_model.evaluate_model">
<code class="sig-name descname">evaluate_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.evaluate_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.select_model.get_best_model">
<code class="sig-name descname">get_best_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">update_structure</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.get_best_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.select_model.r_free">
<code class="sig-name descname">r_free</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.r_free" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.select_model.r_work">
<code class="sig-name descname">r_work</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.r_work" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.select_model.save_best_model">
<code class="sig-name descname">save_best_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">'best_model.pdb'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.save_best_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.select_model.save_updated_data">
<code class="sig-name descname">save_updated_data</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">'best_model_data.mtz'</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.save_updated_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.select_model.show">
<code class="sig-name descname">show</code><span class="sig-paren">(</span><em class="sig-param">out=&lt;_io.TextIOWrapper name='&lt;stdout&gt;' mode='w' encoding='utf-8'&gt;</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.show" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.select_model.space_group_info">
<code class="sig-name descname">space_group_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.space_group_info" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.select_best_starting_model.select_model.success">
<code class="sig-name descname">success</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.select_model.success" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.select_best_starting_model.strip_model">
<code class="sig-prename descclassname">mmtbx.refinement.select_best_starting_model.</code><code class="sig-name descname">strip_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pdb_hierarchy</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">xray_structure</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">file_name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">params</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">remove_waters</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">remove_hydrogens</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">remove_alt_confs</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">convert_semet_to_met</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">convert_to_isotropic</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">reset_occupancies</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">remove_ligands</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">reset_hetatm_flag</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">preserve_remarks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">preserve_symmetry</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">add_remarks</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.strip_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility for removing extraneous records from a model intended for use in
molecular replacement, etc., including waters, alternate conformations,
and other features specific to a particular dataset.</p>
</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.select_best_starting_model.ucf">
<code class="sig-prename descclassname">mmtbx.refinement.select_best_starting_model.</code><code class="sig-name descname">ucf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">unit_cell</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.select_best_starting_model.ucf" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.tardy">
<span id="mmtbx-refinement-tardy-module"></span><h2>mmtbx.refinement.tardy module<a class="headerlink" href="#module-mmtbx.refinement.tardy" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.tardy.action">
<code class="sig-prename descclassname">mmtbx.refinement.tardy.</code><code class="sig-name descname">action</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tardy_model</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">rmsd_calculator</span></em>, <em class="sig-param"><span class="n">callback</span></em>, <em class="sig-param"><span class="n">log</span></em>, <em class="sig-param"><span class="n">fmodel</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">format_for_phenix_refine</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">refinement_callback</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.action" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.tardy.potential_object">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.tardy.</code><code class="sig-name descname">potential_object</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xray_weight_factor</span></em>, <em class="sig-param"><span class="n">prolsq_repulsion_function_changes</span></em>, <em class="sig-param"><span class="n">fmodels</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">target_weights</span></em>, <em class="sig-param"><span class="n">reduced_geo_manager</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.potential_object" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.tardy.potential_object.crystal_symmetry">
<code class="sig-name descname">crystal_symmetry</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.potential_object.crystal_symmetry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.tardy.potential_object.d_e_pot_d_sites">
<code class="sig-name descname">d_e_pot_d_sites</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sites_moved</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.potential_object.d_e_pot_d_sites" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.tardy.potential_object.e_pot">
<code class="sig-name descname">e_pot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sites_moved</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.potential_object.e_pot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.tardy.run">
<code class="sig-prename descclassname">mmtbx.refinement.tardy.</code><code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fmodels</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">target_weights</span></em>, <em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">log</span></em>, <em class="sig-param"><span class="n">format_for_phenix_refine</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">monitor</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">call_back_after_step</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.tardy.run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.targets">
<span id="mmtbx-refinement-targets-module"></span><h2>mmtbx.refinement.targets module<a class="headerlink" href="#module-mmtbx.refinement.targets" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mmtbx.refinement.targets.ls_ff_weights">
<code class="sig-prename descclassname">mmtbx.refinement.targets.</code><code class="sig-name descname">ls_ff_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f_obs</span></em>, <em class="sig-param"><span class="n">atom</span></em>, <em class="sig-param"><span class="n">B</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.ls_ff_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mmtbx.refinement.targets.ls_sigma_weights">
<code class="sig-prename descclassname">mmtbx.refinement.targets.</code><code class="sig-name descname">ls_sigma_weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f_obs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.ls_sigma_weights" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.targets.phaser_sad_target_functor">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.targets.</code><code class="sig-name descname">phaser_sad_target_functor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f_obs</span></em>, <em class="sig-param"><span class="n">r_free_flags</span></em>, <em class="sig-param"><span class="n">xray_structure</span></em>, <em class="sig-param"><span class="n">f_calc</span></em>, <em class="sig-param"><span class="n">target_memory</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.phaser_sad_target_functor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.targets.phaser_sad_target_functor.prepare_for_minimization">
<code class="sig-name descname">prepare_for_minimization</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.phaser_sad_target_functor.prepare_for_minimization" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.targets.phaser_sad_target_functor.target_memory">
<code class="sig-name descname">target_memory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.phaser_sad_target_functor.target_memory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.targets.target_attributes">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.targets.</code><code class="sig-name descname">target_attributes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">family</span></em>, <em class="sig-param"><span class="n">specialization</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.targets.target_attributes.requires_experimental_phases">
<code class="sig-name descname">requires_experimental_phases</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_attributes.requires_experimental_phases" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.targets.target_attributes.validate">
<code class="sig-name descname">validate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_attributes.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.targets.target_functor">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.targets.</code><code class="sig-name descname">target_functor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">manager</span></em>, <em class="sig-param"><span class="n">alpha_beta</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_functor" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.targets.target_functor.prepare_for_minimization">
<code class="sig-name descname">prepare_for_minimization</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_functor.prepare_for_minimization" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.targets.target_functor.target_function_is_invariant_under_allowed_origin_shifts">
<code class="sig-name descname">target_function_is_invariant_under_allowed_origin_shifts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_functor.target_function_is_invariant_under_allowed_origin_shifts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.targets.target_result">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.targets.</code><code class="sig-name descname">target_result</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">manager</span></em>, <em class="sig-param"><span class="n">core_result</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#mmtbx.refinement.targets.target_result_mixin" title="mmtbx.refinement.targets.target_result_mixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">mmtbx.refinement.targets.target_result_mixin</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.targets.target_result.d_target_d_f_calc_work">
<code class="sig-name descname">d_target_d_f_calc_work</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.d_target_d_f_calc_work" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.targets.target_result.d_target_d_f_model_work">
<code class="sig-name descname">d_target_d_f_model_work</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.d_target_d_f_model_work" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.targets.target_result.target_per_reflection">
<code class="sig-name descname">target_per_reflection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.target_per_reflection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.targets.target_result.target_test">
<code class="sig-name descname">target_test</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.target_test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.targets.target_result.target_work">
<code class="sig-name descname">target_work</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result.target_work" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mmtbx.refinement.targets.target_result_mixin">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.targets.</code><code class="sig-name descname">target_result_mixin</code><a class="headerlink" href="#mmtbx.refinement.targets.target_result_mixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.targets.target_result_mixin.d_target_d_site_cart">
<code class="sig-name descname">d_target_d_site_cart</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result_mixin.d_target_d_site_cart" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mmtbx.refinement.targets.target_result_mixin.gradients_wrt_atomic_parameters">
<code class="sig-name descname">gradients_wrt_atomic_parameters</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">selection</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">site</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">u_iso</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">u_aniso</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">occupancy</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tan_b_iso_max</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">u_iso_refinable_params</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.targets.target_result_mixin.gradients_wrt_atomic_parameters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mmtbx.refinement.weights_params">
<span id="mmtbx-refinement-weights-params-module"></span><h2>mmtbx.refinement.weights_params module<a class="headerlink" href="#module-mmtbx.refinement.weights_params" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="mmtbx-refinement-wx-tardy-pdb-module">
<h2>mmtbx.refinement.wx_tardy_pdb module<a class="headerlink" href="#mmtbx-refinement-wx-tardy-pdb-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mmtbx.refinement">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mmtbx.refinement" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mmtbx.refinement.monitors">
<em class="property">class </em><code class="sig-prename descclassname">mmtbx.refinement.</code><code class="sig-name descname">monitors</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">fmodels</span></em>, <em class="sig-param"><span class="n">log</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">neutron_refinement</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">call_back_handler</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.monitors" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt id="mmtbx.refinement.monitors.collect">
<code class="sig-name descname">collect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">step</span></em>, <em class="sig-param"><span class="n">fmodels</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">model</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">rigid_body_shift_accumulator</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.refinement.monitors.collect" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">mmtbx.refinement package</a><ul>
<li><a class="reference internal" href="#subpackages">Subpackages</a></li>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.adp_refinement">mmtbx.refinement.adp_refinement module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.anomalous_scatterer_groups">mmtbx.refinement.anomalous_scatterer_groups module</a></li>
<li><a class="reference internal" href="#mmtbx-refinement-fit-rotamers-module">mmtbx.refinement.fit_rotamers module</a></li>
<li><a class="reference internal" href="#mmtbx-refinement-flip-peptides-module">mmtbx.refinement.flip_peptides module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.geometry_minimization">mmtbx.refinement.geometry_minimization module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.group">mmtbx.refinement.group module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.inspect_tardy_trajectory">mmtbx.refinement.inspect_tardy_trajectory module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.minimization">mmtbx.refinement.minimization module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.minimization_ncs_constraints">mmtbx.refinement.minimization_ncs_constraints module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.occupancies">mmtbx.refinement.occupancies module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.orca">mmtbx.refinement.orca module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.print_statistics">mmtbx.refinement.print_statistics module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.refinement_flags">mmtbx.refinement.refinement_flags module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.rigid_body">mmtbx.refinement.rigid_body module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.select_best_starting_model">mmtbx.refinement.select_best_starting_model module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.tardy">mmtbx.refinement.tardy module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.targets">mmtbx.refinement.targets module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement.weights_params">mmtbx.refinement.weights_params module</a></li>
<li><a class="reference internal" href="#mmtbx-refinement-wx-tardy-pdb-module">mmtbx.refinement.wx_tardy_pdb module</a></li>
<li><a class="reference internal" href="#module-mmtbx.refinement">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mmtbx.real_space.html"
                        title="previous chapter">mmtbx.real_space package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mmtbx.refinement.ensemble_refinement.html"
                        title="next chapter">mmtbx.refinement.ensemble_refinement package</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/mmtbx/mmtbx.refinement.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mmtbx.refinement.ensemble_refinement.html" title="mmtbx.refinement.ensemble_refinement package"
             >next</a> |</li>
        <li class="right" >
          <a href="mmtbx.real_space.html" title="mmtbx.real_space package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CCTBX Developer documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="mmtbx.html" >mmtbx - macromolecular crystallography</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">mmtbx.refinement package</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, University of California.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.3.1.
    </div>
  </body>
</html>