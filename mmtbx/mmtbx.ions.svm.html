
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>mmtbx.ions.svm package &#8212; CCTBX Developer documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mmtbx.ions.svm.dump_sites module" href="mmtbx.ions.svm.dump_sites.html" />
    <link rel="prev" title="mmtbx.ions package" href="mmtbx.ions.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mmtbx.ions.svm.dump_sites.html" title="mmtbx.ions.svm.dump_sites module"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="mmtbx.ions.html" title="mmtbx.ions package"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CCTBX Developer documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="mmtbx.html" >mmtbx - macromolecular crystallography</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="mmtbx.ions.html" accesskey="U">mmtbx.ions package</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="mmtbx-ions-svm-package">
<h1>mmtbx.ions.svm package<a class="headerlink" href="#mmtbx-ions-svm-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="mmtbx.ions.svm.dump_sites.html">mmtbx.ions.svm.dump_sites module</a></li>
<li class="toctree-l1"><a class="reference internal" href="mmtbx.ions.svm.utils.html">mmtbx.ions.svm.utils module</a></li>
</ul>
</div>
</div>
<div class="section" id="module-mmtbx.ions.svm">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mmtbx.ions.svm" title="Permalink to this headline">¶</a></h2>
<p>A set of functions to act upon ChemicalEnvironment and ScatteringEnvironment and
produce a single class and vector of features for use with a classifier.</p>
<p>This module relies on a SVM classifier generated by the module within
phenix_dev.ion_identification.nader_ml. See that module’s description for more
details.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><code class="xref py py-mod docutils literal notranslate"><span class="pre">phenix_dev.ion_identification.nader_ml</span></code></p>
</div>
<dl class="function">
<dt id="mmtbx.ions.svm.ion_anomalous_vector">
<code class="descclassname">mmtbx.ions.svm.</code><code class="descname">ion_anomalous_vector</code><span class="sig-paren">(</span><em>scatter_env</em>, <em>elements=None</em>, <em>ratios=True</em>, <em>anom_peak=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.ion_anomalous_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector of the anomalous features of a site. These can either include
the f’’ / f’‘_expected for a variety of ion identities or the exact anomalous
peak height.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scatter_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ScatteringEnvironment" title="mmtbx.ions.environment.ScatteringEnvironment"><em>mmtbx.ions.environment.ScatteringEnvironment</em></a>) – An object containing information about the scattering environment at a
site.</li>
<li><strong>elements</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of elements to include when calculating f’‘_expected values. If
unset, takes the list from mmtbx.ions.ALLOWED_IONS.</li>
<li><strong>ratios</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – If False, instead of calculating ratios, just return a vector of the
wavelength, f’, and f’‘.</li>
<li><strong>anom_peak</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to use the actual height of the anomalous map instead of the
calculated f’’ values.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A vector containing quantitative properties for classification.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array of float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_class">
<code class="descclassname">mmtbx.ions.svm.</code><code class="descname">ion_class</code><span class="sig-paren">(</span><em>chem_env</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.ion_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the class name associated with the ion, analogous to the chemical
ID.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chem_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ChemicalEnvironment" title="mmtbx.ions.environment.ChemicalEnvironment"><em>mmtbx.ions.environment.ChemicalEnvironment</em></a>) – The object to extract the ion class from.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The class associated with the ion (i.e. “HOH” or “ZN”).</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_electron_density_vector">
<code class="descclassname">mmtbx.ions.svm.</code><code class="descname">ion_electron_density_vector</code><span class="sig-paren">(</span><em>scatter_env</em>, <em>b_iso=False</em>, <em>occ=False</em>, <em>diff_peak=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.ion_electron_density_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector containing information about the electron density around
the site. Currently this only includes the site’s peak in the 2FoFc map. May
be expanded in the future to include information about the volume of density
around the site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scatter_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ScatteringEnvironment" title="mmtbx.ions.environment.ScatteringEnvironment"><em>mmtbx.ions.environment.ScatteringEnvironment</em></a>) – An object containing information about the scattering environment at a
site.</li>
<li><strong>b_iso</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include the atom’s refined isotropic b-factor, divided by the mean
b-factor of solvent molecules in the structure.</li>
<li><strong>occ</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include the atom’s refined occupancy.</li>
<li><strong>diff_peak</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include the difference map peak height.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A vector containing quantitative properties for classification.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array of float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_geometry_vector">
<code class="descclassname">mmtbx.ions.svm.</code><code class="descname">ion_geometry_vector</code><span class="sig-paren">(</span><em>chem_env</em>, <em>geometry_names=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.ion_geometry_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector for a site’s geometry. For each geometry in geometry_names
the vector contains a 1 if that geometry is present at the site and 0
otherwise.</p>
<p>A single boolean was chosen after some trial and error with an SVM as
differences in deviations &lt; 15 degrees were not found to be significant in
helping to diffentiate ions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chem_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ChemicalEnvironment" title="mmtbx.ions.environment.ChemicalEnvironment"><em>mmtbx.ions.environment.ChemicalEnvironment</em></a>) – A object containing information about the chemical environment at a site.</li>
<li><strong>geometry_names</strong> (<em>list of str</em><em>, </em><em>optional</em>) – A list of geometry names to check for. If unset, take names from
mmtbx.ions.SUPPORTED_GEOMETRY_NAMES.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A vector containing quantitative properties for classification.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array of float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_model_vector">
<code class="descclassname">mmtbx.ions.svm.</code><code class="descname">ion_model_vector</code><span class="sig-paren">(</span><em>scatter_env</em>, <em>d_min=True</em>, <em>nearest_res=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.ion_model_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector containing information about the general properties of the
model in which the site is found. Currently this only includes the minimum
resolution of the data set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>scatter_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ScatteringEnvironment" title="mmtbx.ions.environment.ScatteringEnvironment"><em>mmtbx.ions.environment.ScatteringEnvironment</em></a>) – An object containing information about the scattering environment at a
site.</li>
<li><strong>d_min</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include the high resolution associated with the model as a feature.</li>
<li><strong>nearest_res</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.float" title="scitbx.array_family.flex.float"><em>float</em></a><em>, </em><em>optional</em>) – If not None, the nearest value to round d_min to. This value has no effect
if nearest_res is False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A vector containing quantitative properties for classification.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array of float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_nearby_atoms_vector">
<code class="descclassname">mmtbx.ions.svm.</code><code class="descname">ion_nearby_atoms_vector</code><span class="sig-paren">(</span><em>chem_env</em>, <em>environments=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.ion_nearby_atoms_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector for the identities of the ions surrounding a site. Returns
a vector with a count of coordinating nitrogens, oxygens, sulfurs, and
chlorines.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chem_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ChemicalEnvironment" title="mmtbx.ions.environment.ChemicalEnvironment"><em>mmtbx.ions.environment.ChemicalEnvironment</em></a>) – A object containing information about the chemical environment at a site.</li>
<li><strong>environments</strong> (<em>list of int</em><em>, </em><em>optional</em>) – A list of environments to check for. If unset, takes values from
mmtbx.ions.environment.N_SUPPORTED_ENVIRONMENTS.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A vector containing quantitative properties for classification.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array of float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_valence_vector">
<code class="descclassname">mmtbx.ions.svm.</code><code class="descname">ion_valence_vector</code><span class="sig-paren">(</span><em>chem_env</em>, <em>elements=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.ion_valence_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the BVS and VECSUM values for a variety of ion identities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chem_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ChemicalEnvironment" title="mmtbx.ions.environment.ChemicalEnvironment"><em>mmtbx.ions.environment.ChemicalEnvironment</em></a>) – A object containing information about the chemical environment at a site.</li>
<li><strong>elements</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of elements to include when calculating BVS and VECSUM values. If
unset, takes the list from mmtbx.ions.ALLOWED_IONS.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A vector containing quantitative properties for classification.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array of float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.ion_vector">
<code class="descclassname">mmtbx.ions.svm.</code><code class="descname">ion_vector</code><span class="sig-paren">(</span><em>chem_env</em>, <em>scatter_env</em>, <em>use_scatter=True</em>, <em>use_chem=True</em>, <em>b_iso=True</em>, <em>occ=True</em>, <em>diff_peak=True</em>, <em>geometry=True</em>, <em>elements=None</em>, <em>valence=True</em>, <em>anom=True</em>, <em>ratios=True</em>, <em>anom_peak=False</em>, <em>d_min=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.ion_vector" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a vector containing all of the useful properties contained
within ion. Merges together the vectors from ion_*_vector().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chem_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ChemicalEnvironment" title="mmtbx.ions.environment.ChemicalEnvironment"><em>mmtbx.ions.environment.ChemicalEnvironment</em></a>) – A object containing information about the chemical environment at a site.</li>
<li><strong>scatter_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ScatteringEnvironment" title="mmtbx.ions.environment.ScatteringEnvironment"><em>mmtbx.ions.environment.ScatteringEnvironment</em></a><em>, </em><em>optional</em>) – An object containing information about the scattering environment at a
site.</li>
<li><strong>use_scatter</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include information derived from the scattering environment (b-factor,
occupancy, FoFc peak, 2FoFc peak and width, f’’ values)</li>
<li><strong>use_chem</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include information derived from the chemical environment (Geometry,
coordinating atom identities, valences).</li>
<li><strong>b_iso</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include the atom’s refined isotropic b-factor, divided by the mean
b-factor of solvent molecules in the structure.</li>
<li><strong>occ</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include the atom’s refined occupancy.</li>
<li><strong>diff_peak</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include the difference map peak height.</li>
<li><strong>geometry</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include information about the presence of various geometries.</li>
<li><strong>elements</strong> (<em>list of str</em><em>, </em><em>optional</em>) – <dl class="docutils">
<dt>List of elements to include when calculating BVS, VECSUM, and f’‘_expected</dt>
<dd>values. If unset, takes the list from mmtbx.ions.ALLOWED_IONS.</dd>
</dl>
</li>
<li><strong>valence</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include BVS and VECSUM values.</li>
<li><strong>anom</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include anomalous scattering information.</li>
<li><strong>ratios</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Use f’’ / f’’ expected, instead of raw f’’ and f’ values.</li>
<li><strong>anom_peak</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to use the actual height of the anomalous map instead of the
calculated f’’ values.</li>
<li><strong>d_min</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – Include the high resolution associated with the model as a feature.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A vector containing quantitative properties for classification.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array of float</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#mmtbx.ions.svm.ion_model_vector" title="mmtbx.ions.svm.ion_model_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">ion_model_vector()</span></code></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_electron_density_vector" title="mmtbx.ions.svm.ion_electron_density_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">ion_electron_density_vector()</span></code></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_geometry_vector" title="mmtbx.ions.svm.ion_geometry_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">ion_geometry_vector()</span></code></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_nearby_atoms_vector" title="mmtbx.ions.svm.ion_nearby_atoms_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">ion_nearby_atoms_vector()</span></code></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_valence_vector" title="mmtbx.ions.svm.ion_valence_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">ion_valence_vector()</span></code></a>, <a class="reference internal" href="#mmtbx.ions.svm.ion_anomalous_vector" title="mmtbx.ions.svm.ion_anomalous_vector"><code class="xref py py-func docutils literal notranslate"><span class="pre">ion_anomalous_vector()</span></code></a></p>
</div>
</dd></dl>

<dl class="class">
<dt id="mmtbx.ions.svm.manager">
<em class="property">class </em><code class="descclassname">mmtbx.ions.svm.</code><code class="descname">manager</code><span class="sig-paren">(</span><em>fmodel</em>, <em>pdb_hierarchy</em>, <em>xray_structure</em>, <em>params=None</em>, <em>wavelength=None</em>, <em>connectivity=None</em>, <em>nproc=1</em>, <em>verbose=False</em>, <em>log=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mmtbx.ions.identify.html#mmtbx.ions.identify.manager" title="mmtbx.ions.identify.manager"><code class="xref py py-class docutils literal notranslate"><span class="pre">mmtbx.ions.identify.manager</span></code></a></p>
<dl class="method">
<dt id="mmtbx.ions.svm.manager.analyze_water">
<code class="descname">analyze_water</code><span class="sig-paren">(</span><em>i_seq</em>, <em>debug=True</em>, <em>candidates=&lt;libtbx.AutoType object&gt;</em>, <em>filter_outputs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.manager.analyze_water" title="Permalink to this definition">¶</a></dt>
<dd><p>Analyzes a single water site using a SVM to decide whether to re-assign it
as an ion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i_seq</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.int" title="scitbx.array_family.flex.int"><em>int</em></a>) – </li>
<li><strong>debug</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – </li>
<li><strong>candidates</strong> (<em>list of str</em><em>, </em><em>optional</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#mmtbx.ions.svm.svm_prediction" title="mmtbx.ions.svm.svm_prediction">svm_prediction</a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mmtbx.ions.svm.manager.analyze_waters">
<code class="descname">analyze_waters</code><span class="sig-paren">(</span><em>out=&lt;open file '&lt;stdout&gt;'</em>, <em>mode 'w'&gt;</em>, <em>debug=True</em>, <em>candidates=&lt;libtbx.AutoType object&gt;</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.manager.analyze_waters" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses a SVM to analyze all of a model’s water sites and decide whether to
re-assign them as ions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>out</strong> (<em>file</em><em>, </em><em>optional</em>) – </li>
<li><strong>debug</strong> (<a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.bool" title="scitbx.array_family.flex.bool"><em>bool</em></a><em>, </em><em>optional</em>) – </li>
<li><strong>candidates</strong> (<em>list of str</em><em>, </em><em>optional</em>) – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of svm_prediction</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mmtbx.ions.svm.predict_ion">
<code class="descclassname">mmtbx.ions.svm.</code><code class="descname">predict_ion</code><span class="sig-paren">(</span><em>chem_env</em>, <em>scatter_env</em>, <em>elements=None</em>, <em>svm_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.predict_ion" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the trained classifier to predict the ions that most likely fit a given
list of features about the site.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chem_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ChemicalEnvironment" title="mmtbx.ions.environment.ChemicalEnvironment"><em>mmtbx.ions.environment.ChemicalEnvironment</em></a>) – A object containing information about the chemical environment at a site.</li>
<li><strong>scatter_env</strong> (<a class="reference internal" href="mmtbx.ions.environment.html#mmtbx.ions.environment.ScatteringEnvironment" title="mmtbx.ions.environment.ScatteringEnvironment"><em>mmtbx.ions.environment.ScatteringEnvironment</em></a><em>, </em><em>optional</em>) – An object containing information about the scattering environment at a
site.</li>
<li><strong>elements</strong> (<em>list of str</em><em>, </em><em>optional</em>) – A list of elements to include within the prediction. Must be a subset of
mmtbx.ions.svm.ALLOWED_IONS. Note: Water is not added to elements by
default.</li>
<li><strong>svm_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – The SVM to use for prediction. By default, the SVM trained on heavy atoms
and calcium in the presence of anomalous data is used</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A sorted list of classes and the predicted probabilities associated with
each or None if the trained classifier cannot be loaded.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list of tuple of str, <a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.float" title="scitbx.array_family.flex.float">float</a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)">None</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="mmtbx.ions.svm.svm_prediction">
<em class="property">class </em><code class="descclassname">mmtbx.ions.svm.</code><code class="descname">svm_prediction</code><span class="sig-paren">(</span><em>**kwds</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../libtbx/index.html#libtbx.slots_getstate_setstate_default_initializer" title="libtbx.slots_getstate_setstate_default_initializer"><code class="xref py py-class docutils literal notranslate"><span class="pre">libtbx.slots_getstate_setstate_default_initializer</span></code></a></p>
<p>Contains information about a SVM’s prediction of a site’s identity.</p>
<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.i_seq">
<code class="descname">i_seq</code><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.i_seq" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="../scitbx/scitbx.array_family.html#scitbx.array_family.flex.int" title="scitbx.array_family.flex.int">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.pdb_id_str">
<code class="descname">pdb_id_str</code><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.pdb_id_str" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.atom_info_str">
<code class="descname">atom_info_str</code><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.atom_info_str" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)">str</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.map_stats">
<code class="descname">map_stats</code><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.map_stats" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="../libtbx/index.html#libtbx.group_args" title="libtbx.group_args">group_args</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.atom_types">
<code class="descname">atom_types</code><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.atom_types" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list of str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.scores">
<code class="descname">scores</code><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Probabilities associated with each element listed by atom_types.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">list of float</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mmtbx.ions.svm.svm_prediction.final_choice">
<code class="descname">final_choice</code><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.final_choice" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body"><a class="reference internal" href="mmtbx.ions.html#mmtbx.ions.metal_parameters" title="mmtbx.ions.metal_parameters">mmtbx.ions.metal_parameters</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">atom_info_str</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">atom_types</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">final_choice</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">i_seq</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">map_stats</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">pdb_id_str</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">scores</code></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mmtbx.ions.svm.svm_prediction.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>out=&lt;open file '&lt;stdout&gt;'</em>, <em>mode 'w'&gt;</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows information about a SVM’s prediction of a site’s identity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>out</strong> (<em>file</em><em>, </em><em>optional</em>) – </li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mmtbx.ions.svm.svm_prediction.show_brief">
<code class="descname">show_brief</code><span class="sig-paren">(</span><em>out=&lt;open file '&lt;stdout&gt;'</em>, <em>mode 'w'&gt;</em>, <em>prefix=''</em><span class="sig-paren">)</span><a class="headerlink" href="#mmtbx.ions.svm.svm_prediction.show_brief" title="Permalink to this definition">¶</a></dt>
<dd><p>Shows a brief description of a SVM’s prediction of a site’s identity, for
use in output as a table.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>out</strong> (<em>file</em><em>, </em><em>optional</em>) – </li>
<li><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">mmtbx.ions.svm package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-mmtbx.ions.svm">Module contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="mmtbx.ions.html"
                        title="previous chapter">mmtbx.ions package</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="mmtbx.ions.svm.dump_sites.html"
                        title="next chapter">mmtbx.ions.svm.dump_sites module</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/mmtbx/mmtbx.ions.svm.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="mmtbx.ions.svm.dump_sites.html" title="mmtbx.ions.svm.dump_sites module"
             >next</a> |</li>
        <li class="right" >
          <a href="mmtbx.ions.html" title="mmtbx.ions package"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">CCTBX Developer documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="mmtbx.html" >mmtbx - macromolecular crystallography</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="mmtbx.ions.html" >mmtbx.ions package</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, University of California.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.4.
    </div>
  </body>
</html>